"use strict";function Sorter(){}Sorter.prototype.sort=function(g,f){f=f||0;for(var e=0,a=this.keys.length;e<a;e++){var d=this.keys[e];var c=d.slice(1);var b=g.indexOf(c,f);if(b!==-1){do{if(b!==f){g.splice(b,1);g.splice(f,0,c)}f++}while((b=g.indexOf(c,f))!==-1);return this[d].sort(g,f)}}return g};function TokenChain(){}TokenChain.prototype={add:function(b){var a=this;b.forEach(function(d){var c="$"+d;if(!a[c]){a[c]=[];a[c].processed=0}a[c].push(b)})},createSorter:function(){var a=this;var b=new Sorter();b.keys=Object.keys(a).sort(function(e,d){var c=a[e].length;var f=a[d].length;return c<f?1:c>f?-1:e<d?-1:e>d?1:0}).filter(function(e){if(a[e].processed<a[e].length){var d=e.slice(1);var c=new TokenChain();a[e].forEach(function(g){var f;while((f=g.indexOf(d))!==-1){g.splice(f,1)}g.forEach(function(h){a["$"+h].processed++});c.add(g.slice(0))});b[e]=c.createSorter();return true}return false});return b}};module.exports=TokenChain;