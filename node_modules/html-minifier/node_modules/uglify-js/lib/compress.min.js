"use strict";function Compressor(c,g){if(!(this instanceof Compressor)){return new Compressor(c,g)}TreeTransformer.call(this,this.before,this.after);this.options=defaults(c,{arguments:!g,booleans:!g,collapse_vars:!g,comparisons:!g,conditionals:!g,dead_code:!g,drop_console:false,drop_debugger:!g,evaluate:!g,expression:false,global_defs:{},hoist_funs:false,hoist_props:!g,hoist_vars:false,ie8:false,if_return:!g,inline:!g,join_vars:!g,keep_fargs:true,keep_fnames:false,keep_infinity:false,loops:!g,negate_iife:!g,passes:1,properties:!g,pure_getters:!g&&"strict",pure_funcs:null,reduce_funcs:!g,reduce_vars:!g,sequences:!g,side_effects:!g,switches:!g,top_retain:null,toplevel:!!(c&&c.top_retain),typeofs:!g,unsafe:false,unsafe_comps:false,unsafe_Function:false,unsafe_math:false,unsafe_proto:false,unsafe_regexp:false,unsafe_undefined:false,unused:!g,warnings:false},true);var a=this.options.global_defs;if(typeof a=="object"){for(var d in a){if(/^@/.test(d)&&HOP(a,d)){a[d.slice(1)]=parse(a[d],{expression:true})}}}if(this.options.inline===true){this.options.inline=3}var f=this.options.pure_funcs;if(typeof f=="function"){this.pure_funcs=f}else{this.pure_funcs=f?function(i){return f.indexOf(i.expression.print_to_string())<0}:return_true}var b=this.options.top_retain;if(b instanceof RegExp){this.top_retain=function(i){return b.test(i.name)}}else{if(typeof b=="function"){this.top_retain=b}else{if(b){if(typeof b=="string"){b=b.split(/,/)}this.top_retain=function(i){return b.indexOf(i.name)>=0}}}}var e=this.options.toplevel;this.toplevel=typeof e=="string"?{funcs:/funcs/.test(e),vars:/vars/.test(e)}:{funcs:e,vars:e};var h=this.options.sequences;this.sequences_limit=h==1?800:h|0;this.warnings_produced={}}Compressor.prototype=new TreeTransformer;merge(Compressor.prototype,{option:function(a){return this.options[a]},exposed:function(c){if(c.global){for(var b=0,a=c.orig.length;b<a;b++){if(!this.toplevel[c.orig[b] instanceof AST_SymbolDefun?"funcs":"vars"]){return true}}}return false},compress:function(f){if(this.option("expression")){f.process_expression(true)}var e=+this.options.passes||1;var a=1/0;var g=false;var b={ie8:this.option("ie8")};for(var d=0;d<e;d++){f.figure_out_scope(b);if(d>0||this.option("reduce_vars")){f.reset_opt_flags(this)}f=f.transform(this);if(e>1){var c=0;f.walk(new TreeWalker(function(){c++}));this.info("pass "+d+": last_count: "+a+", count: "+c);if(c<a){a=c;g=false}else{if(g){break}else{g=true}}}}if(this.option("expression")){f.process_expression(false)}return f},info:function(){if(this.options.warnings=="verbose"){AST_Node.warn.apply(AST_Node,arguments)}},warn:function(c,a){if(this.options.warnings){var b=string_template(c,a);if(!(b in this.warnings_produced)){this.warnings_produced[b]=true;AST_Node.warn.apply(AST_Node,arguments)}}},clear_warnings:function(){this.warnings_produced={}},before:function(d,b,c){if(d._squeezed){return d}var e=false;if(d instanceof AST_Scope){d=d.hoist_properties(this);d=d.hoist_declarations(this);e=true}b(d,this);b(d,this);var a=d.optimize(this);if(e&&a instanceof AST_Scope){a.drop_unused(this);b(a,this)}if(a===d){a._squeezed=true}return a}});(function(){function O(U,T){U.DEFMETHOD("optimize",function(X){var V=this;if(V._optimized){return V}if(X.has_directive("use asm")){return V}var W=T(V,X);W._optimized=true;return W})}O(AST_Node,function(T,U){return T});AST_Node.DEFMETHOD("equivalent_to",function(T){return this.TYPE==T.TYPE&&this.print_to_string()==T.print_to_string()});AST_Scope.DEFMETHOD("process_expression",function(V,W){var T=this;var U=new TreeTransformer(function(Y){if(V&&Y instanceof AST_SimpleStatement){return c(AST_Return,Y,{value:Y.body})}if(!V&&Y instanceof AST_Return){if(W){var Z=Y.value&&Y.value.drop_side_effect_free(W,true);return Z?c(AST_SimpleStatement,Y,{body:Z}):c(AST_EmptyStatement,Y)}return c(AST_SimpleStatement,Y,{body:Y.value||c(AST_UnaryPrefix,Y,{operator:"void",expression:c(AST_Number,Y,{value:0})})})}if(Y instanceof AST_Lambda&&Y!==T){return Y}if(Y instanceof AST_Block){var X=Y.body.length-1;if(X>=0){Y.body[X]=Y.body[X].transform(U)}}else{if(Y instanceof AST_If){Y.body=Y.body.transform(U);if(Y.alternative){Y.alternative=Y.alternative.transform(U)}}else{if(Y instanceof AST_With){Y.body=Y.body.transform(U)}}}return Y});T.transform(U)});function H(Y,U){U=Q(U);if(U instanceof AST_Node){return}var X;if(Y instanceof AST_Array){var W=Y.elements;if(U=="length"){return w(W.length,Y)}if(typeof U=="number"&&U in W){X=W[U]}}else{if(Y instanceof AST_Object){U=""+U;var V=Y.properties;for(var T=V.length;--T>=0;){var Z=V[T];if(!(Z instanceof AST_ObjectKeyVal)){return}if(!X&&V[T].key===U){X=V[T].value}}}}return X instanceof AST_SymbolRef&&X.fixed_value()||X}function y(Y,Z,V,ab,U,aa){var ac=Z.parent(U);var W=e(V,ac);if(W){return W}if(!aa&&ac instanceof AST_Call&&ac.expression===V&&!ac.is_expr_pure(Y)&&(!(ab instanceof AST_Function)||!(ac instanceof AST_New)&&ab.contains_this())){return true}if(ac instanceof AST_Array){return y(Y,Z,ac,ac,U+1)}if(ac instanceof AST_ObjectKeyVal&&V===ac.value){var X=Z.parent(U+1);return y(Y,Z,X,X,U+2)}if(ac instanceof AST_PropAccess&&ac.expression===V){var T=H(ab,ac.property);return !aa&&y(Y,Z,ac,T,U+1)}}(function(V){V(AST_Node,noop);function ae(ah,aj,ai){ai.assignments=0;ai.chained=false;ai.direct_access=false;ai.escaped=false;if(ai.scope.pinned()){ai.fixed=false}else{if(!aj.exposed(ai)){ai.fixed=ai.init}else{ai.fixed=false}}if(ai.fixed instanceof AST_Defun&&!all(ai.references,function(al){var ak=al.scope;do{if(ai.scope===ak){return true}}while(ak instanceof AST_Function&&(ak=ak.parent_scope))})){ah.defun_ids[ai.id]=false}ai.recursive_refs=0;ai.references=[];ai.should_replace=undefined;ai.single_use=undefined}function ab(ah,aj,ai){ai.variables.each(function(ak){ae(ah,aj,ak);if(ak.fixed===null){ak.safe_ids=ah.safe_ids;Y(ah,ak,true)}else{if(ak.fixed){ah.loop_ids[ak.id]=ah.in_loop;Y(ah,ak,true)}}});ai.may_call_this=function(){ai.may_call_this=noop;if(!ai.contains_this()){return}ai.functions.each(function(ak){if(ak.init instanceof AST_Defun&&!(ak.id in ah.defun_ids)){ah.defun_ids[ak.id]=false}})}}function U(aj,ak){if(ak.id in aj.defun_ids){var ai=aj.defun_ids[ak.id];if(!ai){return}var ah=aj.defun_visited[ak.id];if(ai===aj.safe_ids){if(!ah){return ak.fixed}}else{if(ah){ak.init.enclosed.forEach(function(al){if(ak.init.variables.get(al.name)===al){return}if(!ac(aj,al)){al.fixed=false}})}else{aj.defun_ids[ak.id]=false}}}else{if(!aj.in_loop){aj.defun_ids[ak.id]=aj.safe_ids;return ak.fixed}aj.defun_ids[ak.id]=false}}function X(ah,ai){ai.functions.each(function(aj){if(aj.init instanceof AST_Defun&&!ah.defun_visited[aj.id]){ah.defun_ids[aj.id]=ah.safe_ids;aj.init.walk(ah)}})}function ad(ah){ah.safe_ids=Object.create(ah.safe_ids)}function ag(ah){ah.safe_ids=Object.getPrototypeOf(ah.safe_ids)}function Y(ah,aj,ai){ah.safe_ids[aj.id]=ai}function ac(ah,ai){if(ah.safe_ids[ai.id]){if(ai.fixed==null){var aj=ai.orig[0];if(aj instanceof AST_SymbolFunarg||aj.name=="arguments"){return false}ai.fixed=c(AST_Undefined,aj)}return true}return ai.fixed instanceof AST_Defun}function aa(ah,ak,ai,aj){if(ak.fixed===undefined){return true}if(ak.fixed===null&&ak.safe_ids){ak.safe_ids[ak.id]=false;delete ak.safe_ids;return true}if(!HOP(ah.safe_ids,ak.id)){return false}if(!ac(ah,ak)){return false}if(ak.fixed===false){return false}if(ak.fixed!=null&&(!aj||ak.references.length>ak.assignments)){return false}if(ak.fixed instanceof AST_Defun){return aj instanceof AST_Node&&ak.fixed.parent_scope===ai}return all(ak.orig,function(al){return !(al instanceof AST_SymbolDefun||al instanceof AST_SymbolLambda)})}function Z(ah,aj,ai){return aj.option("unused")&&!ai.scope.pinned()&&ai.references.length-ai.recursive_refs==1&&ah.loop_ids[ai.id]===ah.in_loop}function af(ah){if(!ah){return false}return ah.is_constant()||ah instanceof AST_Lambda||ah instanceof AST_This}function W(al,am,ap,ai,an,ah,ak){var ao=al.parent(ah);if(an&&an.is_constant()){return}if(ao instanceof AST_Assign&&ao.operator=="="&&ai===ao.right||ao instanceof AST_Call&&(ai!==ao.expression||ao instanceof AST_New)||ao instanceof AST_Exit&&ai===ao.value&&ai.scope!==am.scope||ao instanceof AST_VarDef&&ai===ao.value){if(ak>1&&!(an&&an.is_constant_expression(ap))){ak=1}if(!am.escaped||am.escaped>ak){am.escaped=ak}return}else{if(ao instanceof AST_Array||ao instanceof AST_Binary&&j[ao.operator]||ao instanceof AST_Conditional&&ai!==ao.condition||ao instanceof AST_Sequence&&ai===ao.tail_node()){W(al,am,ap,ao,ao,ah+1,ak)}else{if(ao instanceof AST_ObjectKeyVal&&ai===ao.value){var aj=al.parent(ah+1);W(al,am,ap,aj,aj,ah+2,ak)}else{if(ao instanceof AST_PropAccess&&ai===ao.expression){an=H(an,ao.property);W(al,am,ap,ao,an,ah+1,ak+1);if(an){return}}}}}if(ah>0){return}if(ao instanceof AST_Sequence&&ai!==ao.tail_node()){return}if(ao instanceof AST_SimpleStatement){return}am.direct_access=true}var T=new TreeWalker(function(ah){if(!(ah instanceof AST_Symbol)){return}var ai=ah.definition();if(!ai){return}if(ah instanceof AST_SymbolRef){ai.references.push(ah)}ai.fixed=false});V(AST_Accessor,function(ah,ai,aj){ad(ah);ab(ah,aj,this);ai();ag(ah);X(ah,this);return true});V(AST_Assign,function(al,an,ak){var ai=this;var ah=ai.left;if(!(ah instanceof AST_SymbolRef)){return}var am=ah.definition();var aj=am.fixed;if(!aj&&ai.operator!="="){return}if(!aa(al,am,ah.scope,ai.right)){return}var ap=ai.operator=="=";var ao=ap?ai.right:ai;if(y(ak,al,ai,ao,0)){return}am.references.push(ah);am.assignments++;if(!ap){am.chained=true}am.fixed=ap?function(){return ai.right}:function(){return c(AST_Binary,ai,{operator:ai.operator.slice(0,-1),left:aj instanceof AST_Node?aj:aj(),right:ai.right})};Y(al,am,false);ai.right.walk(al);Y(al,am,true);W(al,am,ah.scope,ai,ao,0,1);return true});V(AST_Binary,function(ah){if(!j[this.operator]){return}this.left.walk(ah);ad(ah);this.right.walk(ah);ag(ah);return true});V(AST_Call,function(ai,aj){ai.find_parent(AST_Scope).may_call_this();var al=this.expression;if(!(al instanceof AST_SymbolRef)){return}var ak=al.definition();if(!(ak.fixed instanceof AST_Defun)){return}var ah=U(ai,ak);if(!ah){return}aj();ah.walk(ai);return true});V(AST_Case,function(ah){ad(ah);this.expression.walk(ah);ag(ah);ad(ah);walk_body(this,ah);ag(ah);return true});V(AST_Conditional,function(ah){this.condition.walk(ah);ad(ah);this.consequent.walk(ah);ag(ah);ad(ah);this.alternative.walk(ah);ag(ah);return true});V(AST_Default,function(ah,ai){ad(ah);ai();ag(ah);return true});V(AST_Defun,function(ah,ai,ak){var aj=this.name.definition().id;if(ah.defun_visited[aj]){return true}if(ah.defun_ids[aj]!==ah.safe_ids){return true}ah.defun_visited[aj]=true;this.inlined=false;ad(ah);ab(ah,ak,this);ai();ag(ah);X(ah,this);return true});V(AST_Do,function(ah){var ai=ah.in_loop;ah.in_loop=this;ad(ah);this.body.walk(ah);if(F(this)){ag(ah);ad(ah)}this.condition.walk(ah);ag(ah);ah.in_loop=ai;return true});V(AST_For,function(ah){if(this.init){this.init.walk(ah)}var ai=ah.in_loop;ah.in_loop=this;ad(ah);if(this.condition){this.condition.walk(ah)}this.body.walk(ah);if(this.step){if(F(this)){ag(ah);ad(ah)}this.step.walk(ah)}ag(ah);ah.in_loop=ai;return true});V(AST_ForIn,function(ah){this.init.walk(T);this.object.walk(ah);var ai=ah.in_loop;ah.in_loop=this;ad(ah);this.body.walk(ah);ag(ah);ah.in_loop=ai;return true});V(AST_Function,function(ah,aj,al){var ak=this;ak.inlined=false;ad(ah);ab(ah,al,ak);var ai;if(!ak.name&&(ai=ah.parent()) instanceof AST_Call&&ai.expression===ak){ak.argnames.forEach(function(am,an){var ao=am.definition();if(!ak.uses_arguments&&ao.fixed===undefined){ao.fixed=function(){return ai.args[an]||c(AST_Undefined,ai)};ah.loop_ids[ao.id]=ah.in_loop;Y(ah,ao,true)}else{ao.fixed=false}})}aj();ag(ah);X(ah,ak);return true});V(AST_If,function(ah){this.condition.walk(ah);ad(ah);this.body.walk(ah);ag(ah);if(this.alternative){ad(ah);this.alternative.walk(ah);ag(ah)}return true});V(AST_LabeledStatement,function(ah){ad(ah);this.body.walk(ah);ag(ah);return true});V(AST_SymbolCatch,function(){this.definition().fixed=false});V(AST_SymbolRef,function(ai,ak,an){var am=this.definition();am.references.push(this);if(am.references.length==1&&!am.fixed&&am.orig[0] instanceof AST_SymbolDefun){ai.loop_ids[am.id]=ai.in_loop}var al;if(am.fixed===undefined||!ac(ai,am)||am.single_use=="m"){am.fixed=false}else{if(am.fixed){al=this.fixed_value();if(al instanceof AST_Lambda&&D(ai,am)){am.recursive_refs++}else{if(al&&Z(ai,an,am)){am.single_use=al instanceof AST_Lambda&&!al.pinned()||am.scope===this.scope&&al.is_constant_expression()}else{am.single_use=false}}if(y(an,ai,this,al,0,af(al))){if(am.single_use){am.single_use="m"}else{am.fixed=false}}}}W(ai,am,this.scope,this,al,0,1);var aj;if(am.fixed instanceof AST_Defun&&!((aj=ai.parent()) instanceof AST_Call&&aj.expression===this)){var ah=U(ai,am);if(ah){ah.walk(ai)}}});V(AST_Toplevel,function(ah,ai,aj){this.globals.each(function(ak){ae(ah,aj,ak)});ad(ah);ab(ah,aj,this);ai();ag(ah);X(ah,this);return true});V(AST_Try,function(ah){ad(ah);walk_body(this,ah);ag(ah);if(this.bcatch){ad(ah);this.bcatch.walk(ah);ag(ah)}if(this.bfinally){this.bfinally.walk(ah)}return true});V(AST_Unary,function(ah,ai){var ak=this;if(ak.operator!="++"&&ak.operator!="--"){return}var am=ak.expression;if(!(am instanceof AST_SymbolRef)){return}var al=am.definition();var aj=al.fixed;if(!aj){return}if(!aa(ah,al,am.scope,true)){return}al.references.push(am);al.assignments++;al.chained=true;al.fixed=function(){return c(AST_Binary,ak,{operator:ak.operator.slice(0,-1),left:c(AST_UnaryPrefix,ak,{operator:"+",expression:aj instanceof AST_Node?aj:aj()}),right:c(AST_Number,ak,{value:1})})};Y(ah,al,true);return true});V(AST_VarDef,function(ah,ai){var aj=this;var ak=aj.name.definition();if(aj.value){if(aa(ah,ak,aj.name.scope,aj.value)){ak.fixed=function(){return aj.value};ah.loop_ids[ak.id]=ah.in_loop;Y(ah,ak,false);ai();Y(ah,ak,true);return true}else{ak.fixed=false}}});V(AST_While,function(ah,aj){var ai=ah.in_loop;ah.in_loop=this;ad(ah);aj();ag(ah);ah.in_loop=ai;return true})})(function(U,T){U.DEFMETHOD("reduce_vars",T)});AST_Toplevel.DEFMETHOD("reset_opt_flags",function(U){var T=new TreeWalker(U.option("reduce_vars")?function(W,V){W._squeezed=false;W._optimized=false;return W.reduce_vars(T,V,U)}:function(V){V._squeezed=false;V._optimized=false});T.defun_ids=Object.create(null);T.defun_visited=Object.create(null);T.in_loop=null;T.loop_ids=Object.create(null);T.safe_ids=Object.create(null);this.walk(T)});AST_Symbol.DEFMETHOD("fixed_value",function(){var T=this.definition().fixed;if(!T||T instanceof AST_Node){return T}return T()});AST_SymbolRef.DEFMETHOD("is_immutable",function(){var T=this.definition().orig;return T.length==1&&T[0] instanceof AST_SymbolLambda});function N(T){if(T instanceof AST_This){return true}if(T instanceof AST_SymbolRef){return T.definition().orig[0] instanceof AST_SymbolLambda}if(T instanceof AST_PropAccess){T=T.expression;if(T instanceof AST_SymbolRef){if(T.is_immutable()){return false}T=T.fixed_value()}if(!T){return true}if(T.is_constant()){return true}return N(T)}return false}function h(W,T){var V,U=0;while(V=W.parent(U++)){if(V instanceof AST_Scope){break}if(V instanceof AST_Catch){V=V.argname.definition().scope;break}}return V.find_variable(T)}function c(U,V,T){if(!T){T={}}if(V){if(!T.start){T.start=V.start}if(!T.end){T.end=V.end}}return new U(T)}function I(U,T){if(T.length==1){return T[0]}return c(AST_Sequence,U,{expressions:T.reduce(d,[])})}function w(T,U){switch(typeof T){case"string":return c(AST_String,U,{value:T});case"number":if(isNaN(T)){return c(AST_NaN,U)}if(isFinite(T)){return 1/T<0?c(AST_UnaryPrefix,U,{operator:"-",expression:c(AST_Number,U,{value:-T})}):c(AST_Number,U,{value:T})}return T<0?c(AST_UnaryPrefix,U,{operator:"-",expression:c(AST_Infinity,U)}):c(AST_Infinity,U);case"boolean":return c(T?AST_True:AST_False,U);case"undefined":return c(AST_Undefined,U);default:if(T===null){return c(AST_Null,U,{value:null})}if(T instanceof RegExp){return c(AST_RegExp,U,{value:T})}throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof T}))}}function p(U,T){return T instanceof AST_PropAccess||U.has_directive("use strict")&&J(T)&&T.name=="eval"}function f(W,T,V,U){if(T instanceof AST_UnaryPrefix&&T.operator=="delete"||T.TYPE=="Call"&&T.expression===V&&p(W,U)){return I(V,[c(AST_Number,V,{value:0}),U])}return U}function d(U,T){if(T instanceof AST_Sequence){U.push.apply(U,T.expressions)}else{U.push(T)}return U}function C(T){if(T===null){return[]}if(T instanceof AST_BlockStatement){return T.body}if(T instanceof AST_EmptyStatement){return[]}if(T instanceof AST_Statement){return[T]}throw new Error("Can't convert thing to statement array")}function x(T){if(T===null){return true}if(T instanceof AST_EmptyStatement){return true}if(T instanceof AST_BlockStatement){return T.body.length==0}return false}function n(T){if(T instanceof AST_IterationStatement){return T.body instanceof AST_BlockStatement?T.body:T}return T}function m(T){while(T instanceof AST_PropAccess){T=T.expression}return T}function P(T){if(T.TYPE!="Call"){return false}return T.expression instanceof AST_Function||P(T.expression)}function J(T){return T instanceof AST_SymbolRef&&T.definition().undeclared}var o=makePredicate("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Math Number parseFloat parseInt RangeError ReferenceError RegExp Object setInterval setTimeout String SyntaxError TypeError unescape URIError");AST_SymbolRef.DEFMETHOD("is_declared",function(T){return !this.definition().undeclared||T.option("unsafe")&&o[this.name]});var t=makePredicate("Infinity NaN undefined");function s(T){return T instanceof AST_Infinity||T instanceof AST_NaN||T instanceof AST_Undefined}function z(ai,ad){var ah,X,V;Y();var aj,Z=10;do{aj=false;ag(ai);if(ad.option("dead_code")){al(ai,ad)}if(ad.option("if_return")){ab(ai,ad)}if(ad.sequences_limit>0){ac(ai,ad);aa(ai,ad)}if(ad.option("join_vars")){T(ai)}if(ad.option("collapse_vars")){U(ai,ad)}}while(aj&&Z-->0);function Y(){var am=ad.self(),an=0;do{if(am instanceof AST_Catch||am instanceof AST_Finally){an++}else{if(am instanceof AST_IterationStatement){ah=true}else{if(am instanceof AST_Scope){V=am;break}else{if(am instanceof AST_Try){X=true}}}}}while(am=ad.parent(an++))}function U(aq,aD){if(V.pinned()){return aq}var aV;var aU=[];var aX=aq.length;var ap=new TreeTransformer(function(bf){if(aJ){return bf}if(!aL){if(bf!==aC[aK]){return bf}aK++;if(aK<aC.length){return a8(bf)}aL=true;an=a7(bf,0);if(an===bf){aJ=true}return bf}var be=ap.parent();if(aM(bf,be)){aJ=true;return bf}if(!aH&&aB(bf,be)){aH=be}var bi,bh;if(at&&!(bf instanceof AST_SymbolDeclaration)&&(aN&&(bi=aF.equivalent_to(bf))||aZ&&(bh=aZ(bf,this)))){if(aH&&(bh||!au||!am)){aJ=true;return bf}if(e(bf,be)){if(ay){aT++}return bf}else{aT++;if(ay&&aY instanceof AST_VarDef){return bf}}aj=aJ=true;aD.info("Collapsing {name} [{file}:{line},{col}]",{name:bf.print_to_string(),file:bf.start.file,line:bf.start.line,col:bf.start.col});if(aY instanceof AST_UnaryPostfix){return c(AST_UnaryPrefix,aY,aY)}if(aY instanceof AST_VarDef){var bg=aY.name.definition();if(bg.references.length-bg.replaced==1&&!aD.exposed(bg)){bg.replaced++;return f(aD,be,bf,aY.value)}return c(AST_Assign,aY,{operator:"=",left:c(AST_SymbolRef,aY.name,aY.name),right:aY.value})}aY.write_only=false;return aY}var bd;if(a4(bf,be)||aP(bf)){an=bf;if(bf instanceof AST_Scope){aJ=true}}return a8(bf)},function(bd){if(aJ){return}if(an===bd){aJ=true}if(aH===bd){aH=null}});var aA=new TreeTransformer(function(bd){if(aJ){return bd}if(!aL){if(bd!==aC[aK]){return bd}aK++;if(aK<aC.length){return}aL=true;return bd}if(bd instanceof AST_SymbolRef&&bd.name==aI.name){if(!--aT){aJ=true}if(e(bd,aA.parent())){return bd}aI.replaced++;ay.replaced--;return aY.value.clone()}if(bd instanceof AST_Default||bd instanceof AST_Scope){return bd}});while(--aX>=0){if(aX==0&&aD.option("unused")){bc()}var aC=[];a6(aq[aX]);while(aU.length>0){aC=aU.pop();var aK=0;var aY=aC[aC.length-1];var ay=null;var an=null;var aH=null;var aF=ba(aY);var aQ=az(aY);var bb=aF&&aF.has_side_effects(aD);var aN=aF&&!bb&&!N(aF);var aZ=aQ&&aW(aQ);if(!aN&&!aZ){continue}var aw=ao(aY);var au=aS(aF);if(!bb){bb=aG(aY)}var am=aR();var aP=aY.may_throw(aD)?X?function(bd){return bd.has_side_effects(aD)}:ar:return_false;var ax=aY.name instanceof AST_SymbolFunarg;var aL=ax;var aJ=false,aT=0,at=!aV||!aL;if(!at){for(var a2=aD.self().argnames.lastIndexOf(aY.name)+1;!aJ&&a2<aV.length;a2++){aV[a2].transform(ap)}at=true}for(var a3=aX;!aJ&&a3<aq.length;a3++){aq[a3].transform(ap)}if(ay){var aI=aY.name.definition();if(aJ&&aI.references.length-aI.replaced>aT){aT=false}else{aJ=false;aK=0;aL=ax;for(var a3=aX;!aJ&&a3<aq.length;a3++){aq[a3].transform(aA)}ay.single_use=false}}if(aT&&!a0(aY)){aq.splice(aX,1)}}}function a8(bg){if(bg instanceof AST_Scope){return bg}if(bg instanceof AST_Switch){bg.expression=bg.expression.transform(ap);for(var be=0,bd=bg.body.length;!aJ&&be<bd;be++){var bf=bg.body[be];if(bf instanceof AST_Case){if(!aL){if(bf!==aC[aK]){continue}aK++}bf.expression=bf.expression.transform(ap);if(!am){break}}}aJ=true;return bg}}function aM(be,bd){if(bd instanceof AST_For){return be!==bd.init}if(be instanceof AST_Assign){return be.operator!="="&&aF.equivalent_to(be.left)}if(be instanceof AST_Call){return aF instanceof AST_PropAccess&&aF.equivalent_to(be.expression)}if(be instanceof AST_Debugger){return true}if(be instanceof AST_IterationStatement){return !(be instanceof AST_For)}if(be instanceof AST_LoopControl){return true}if(be instanceof AST_Try){return true}if(be instanceof AST_With){return true}if(am){return false}return be instanceof AST_SymbolRef&&!be.is_declared(aD)}function aB(be,bd){if(bd instanceof AST_Binary){return j[bd.operator]&&bd.left!==be}if(bd instanceof AST_Conditional){return bd.condition!==be}return bd instanceof AST_If&&bd.condition!==be}function a4(bf,be){if(bf instanceof AST_Call){return true}if(bf instanceof AST_Exit){return bb||aF instanceof AST_PropAccess||a1(aF)}if(bf instanceof AST_PropAccess){return bb||bf.expression.may_throw_on_access(aD)}if(bf instanceof AST_SymbolRef){if(a5(bf,be)){return !be||be.operator!="="||be.left!==bf}return bb&&a1(bf)}if(bf instanceof AST_This){return a5(bf,be)}if(bf instanceof AST_VarDef){if(!bf.value){return false}return bf.name.name in aw||bb&&a1(bf.name)}var bd=e(bf.left,bf);if(bd&&bd.name in aw){return true}if(bd instanceof AST_PropAccess){return true}}function bc(){var bj,bi=aD.self();if(bi instanceof AST_Function&&!bi.name&&!bi.uses_arguments&&!bi.pinned()&&(bj=aD.parent()) instanceof AST_Call&&bj.expression===bi){var bh=aD.has_directive("use strict");if(bh&&!member(bh,bi.body)){bh=false}var be=bi.argnames.length;aV=bj.args.slice(be);var bk=Object.create(null);for(var bg=be;--bg>=0;){var bf=bi.argnames[bg];var bd=bj.args[bg];aV.unshift(c(AST_VarDef,bf,{name:bf,value:bd}));if(bf.name in bk){continue}bk[bf.name]=true;if(!bd){bd=c(AST_Undefined,bf).transform(aD)}else{if(bd instanceof AST_Lambda&&bd.pinned()){bd=null}else{bd.walk(new TreeWalker(function(bm){if(!bd){return true}if(bm instanceof AST_SymbolRef&&bi.variables.has(bm.name)){var bl=bm.definition().scope;if(bl!==V){while(bl=bl.parent_scope){if(bl===V){return true}}}bd=null}if(bm instanceof AST_This&&(bh||!this.find_parent(AST_Scope))){bd=null;return true}}))}}if(bd){aU.unshift([c(AST_VarDef,bf,{name:bf,value:bd})])}}}}function a6(bd){aC.push(bd);if(bd instanceof AST_Assign){aU.push(aC.slice());a6(bd.right)}else{if(bd instanceof AST_Binary){a6(bd.left);a6(bd.right)}else{if(bd instanceof AST_Call){a6(bd.expression);bd.args.forEach(a6)}else{if(bd instanceof AST_Case){a6(bd.expression)}else{if(bd instanceof AST_Conditional){a6(bd.condition);a6(bd.consequent);a6(bd.alternative)}else{if(bd instanceof AST_Definitions){bd.definitions.forEach(a6)}else{if(bd instanceof AST_DWLoop){a6(bd.condition);if(!(bd.body instanceof AST_Block)){a6(bd.body)}}else{if(bd instanceof AST_Exit){if(bd.value){a6(bd.value)}}else{if(bd instanceof AST_For){if(bd.init){a6(bd.init)}if(bd.condition){a6(bd.condition)}if(bd.step){a6(bd.step)}if(!(bd.body instanceof AST_Block)){a6(bd.body)}}else{if(bd instanceof AST_ForIn){a6(bd.object);if(!(bd.body instanceof AST_Block)){a6(bd.body)}}else{if(bd instanceof AST_If){a6(bd.condition);if(!(bd.body instanceof AST_Block)){a6(bd.body)}if(bd.alternative&&!(bd.alternative instanceof AST_Block)){a6(bd.alternative)}}else{if(bd instanceof AST_Sequence){bd.expressions.forEach(a6)}else{if(bd instanceof AST_SimpleStatement){a6(bd.body)}else{if(bd instanceof AST_Switch){a6(bd.expression);bd.body.forEach(a6)}else{if(bd instanceof AST_Unary){if(bd.operator=="++"||bd.operator=="--"){aU.push(aC.slice())}else{a6(bd.expression)}}else{if(bd instanceof AST_VarDef){if(bd.value){aU.push(aC.slice());a6(bd.value)}}}}}}}}}}}}}}}}}aC.pop()}function a7(bf,bg,bd){var be=ap.parent(bg);if(be instanceof AST_Assign){if(bd&&!(be.left instanceof AST_PropAccess||be.left.name in aw)){return a7(be,bg+1,bd)}return bf}if(be instanceof AST_Binary){if(bd&&(!j[be.operator]||be.left===bf)){return a7(be,bg+1,bd)}return bf}if(be instanceof AST_Call){return bf}if(be instanceof AST_Case){return bf}if(be instanceof AST_Conditional){if(bd&&be.condition===bf){return a7(be,bg+1,bd)}return bf}if(be instanceof AST_Definitions){return a7(be,bg+1,true)}if(be instanceof AST_Exit){return bd?a7(be,bg+1,bd):bf}if(be instanceof AST_If){if(bd&&be.condition===bf){return a7(be,bg+1,bd)}return bf}if(be instanceof AST_IterationStatement){return bf}if(be instanceof AST_Sequence){return a7(be,bg+1,be.tail_node()!==bf)}if(be instanceof AST_SimpleStatement){return a7(be,bg+1,true)}if(be instanceof AST_Switch){return bf}if(be instanceof AST_Unary){return bf}if(be instanceof AST_VarDef){return bf}return null}function aO(bf){var be=bf.value;if(!(be instanceof AST_SymbolRef)){return}if(be.name=="arguments"){return}var bd=be.definition();if(bd.undeclared){return}return ay=bd}function ba(bf){if(bf instanceof AST_VarDef){var bd=bf.name.definition();if(!member(bf.name,bd.orig)){return}var be=bd.references.length-bd.replaced;if(!be){return}var bg=bd.orig.length-bd.eliminated;if(bg>1&&!(bf.name instanceof AST_SymbolFunarg)||(be>1?aO(bf):!aD.exposed(bd))){return c(AST_SymbolRef,bf.name,bf.name)}}else{return bf[bf instanceof AST_Assign?"left":"expression"]}}function az(bd){if(!(aY instanceof AST_Assign&&aY.operator=="=")){return}return aY.right}function aE(bd){return bd[bd instanceof AST_Assign?"right":"value"]}function aW(bg){if(bg instanceof AST_SymbolRef){var bf=bg.evaluate(aD);if(bf===bg){return a9}return av(bf,a9)}if(bg instanceof AST_This){return a9}if(bg.is_truthy()){return av(true,return_false)}if(bg.is_constant()){return av(bg.evaluate(aD),a9)}if(!(aF instanceof AST_SymbolRef)){return false}if(bg.has_side_effects(aD)){return false}var bd;var be=aF.definition();bg.walk(new TreeWalker(function(bh){if(bd){return true}if(bh instanceof AST_SymbolRef&&bh.definition()===be){bd=true}}));return !bd&&a9}function a9(bd){return aQ.equivalent_to(bd)}function av(bd,be){return function(bg,bf){if(bf.in_boolean_context()){if(bd&&bg.is_truthy()&&!bg.has_side_effects(aD)){return true}if(bg.is_constant()){return !bg.evaluate(aD)==!bd}}return be(bg)}}function ao(bf){var bd=Object.create(null);if(aY instanceof AST_VarDef){bd[aY.name.name]=aF}var be=new TreeWalker(function(bh){var bg=m(bh);if(bg instanceof AST_SymbolRef||bg instanceof AST_This){bd[bg.name]=bd[bg.name]||y(aD,be,bh,bh,0)}});bf.walk(be);return bd}function a0(bg){if(bg.name instanceof AST_SymbolFunarg){var be=aD.self().argnames.indexOf(bg.name);var bd=aD.parent().args;if(bd[be]){bd[be]=c(AST_Number,bd[be],{value:0})}return true}var bf=false;return aq[aX].transform(new TreeTransformer(function(bj,bh,bi){if(bf){return bj}if(bj===bg||bj.body===bg){bf=true;if(bj instanceof AST_VarDef){bj.value=null;return bj}return bi?MAP.skip:null}},function(bh){if(bh instanceof AST_Sequence){switch(bh.expressions.length){case 0:return null;case 1:return bh.expressions[0]}}}))}function aS(bd){var be=m(bd);return be instanceof AST_SymbolRef&&be.definition().scope===V&&!(ah&&(be.name in aw&&aw[be.name]!==bd||aY instanceof AST_Unary||aY instanceof AST_Assign&&aY.operator!="="))}function aG(bd){if(bd instanceof AST_Unary){return false}return aE(bd).has_side_effects(aD)}function aR(){if(bb){return false}if(ay){return true}if(aF instanceof AST_SymbolRef){var bd=aF.definition();if(bd.references.length-bd.replaced==(aY instanceof AST_VarDef?1:2)){return true}}return false}function a5(be,bf){var bd=aw[be.name];if(!bd){return}if(bd!==aF){return !(bf instanceof AST_Call)}aZ=false}function a1(bd){var be=bd.definition();if(be.orig.length==1&&be.orig[0] instanceof AST_SymbolDefun){return false}if(be.scope!==V){return true}return !all(be.references,function(bg){var bf=bg.scope;if(bf.TYPE=="Scope"){bf=bf.parent_scope}return bf===V})}function ar(be,bd){if(be instanceof AST_Assign){return ar(be.left,true)}if(be instanceof AST_Unary){return ar(be.expression,true)}if(be instanceof AST_VarDef){return be.value&&ar(be.value)}if(bd){if(be instanceof AST_Dot){return ar(be.expression,true)}if(be instanceof AST_Sub){return ar(be.expression,true)}if(be instanceof AST_SymbolRef){return be.definition().scope!==V}}return false}}function ag(an){var am=[];for(var ao=0;ao<an.length;){var ap=an[ao];if(ap instanceof AST_BlockStatement){aj=true;ag(ap.body);[].splice.apply(an,[ao,1].concat(ap.body));ao+=ap.body.length}else{if(ap instanceof AST_EmptyStatement){aj=true;an.splice(ao,1)}else{if(ap instanceof AST_Directive){if(am.indexOf(ap.value)<0){ao++;am.push(ap.value)}else{aj=true;an.splice(ao,1)}}else{ao++}}}}}function ab(aC,at){var au=at.self();var am=aG(aC);var ao=au instanceof AST_Lambda;for(var aB=aC.length;--aB>=0;){var aD=aC[aB];var aA=aq(aB);var aw=aC[aA];if(ao&&!aw&&aD instanceof AST_Return){if(!aD.value){aj=true;aC.splice(aB,1);continue}if(aD.value instanceof AST_UnaryPrefix&&aD.value.operator=="void"){aj=true;aC[aB]=c(AST_SimpleStatement,aD,{body:aD.value.expression});continue}}if(aD instanceof AST_If){var aF=v(aD.body);if(az(aF)){if(aF.label){remove(aF.label.thedef.references,aF)}aj=true;aD=aD.clone();aD.condition=aD.condition.negate(at);var ar=an(aD.body,aF);aD.body=c(AST_BlockStatement,aD,{body:C(aD.alternative).concat(ap())});aD.alternative=c(AST_BlockStatement,aD,{body:ar});aC[aB]=aD.transform(at);continue}var aF=v(aD.alternative);if(az(aF)){if(aF.label){remove(aF.label.thedef.references,aF)}aj=true;aD=aD.clone();aD.body=c(AST_BlockStatement,aD.body,{body:C(aD.body).concat(ap())});var ar=an(aD.alternative,aF);aD.alternative=c(AST_BlockStatement,aD.alternative,{body:ar});aC[aB]=aD.transform(at);continue}}if(aD instanceof AST_If&&aD.body instanceof AST_Return){var ax=aD.body.value;if(!ax&&!aD.alternative&&(ao&&!aw||aw instanceof AST_Return&&!aw.value)){aj=true;aC[aB]=c(AST_SimpleStatement,aD.condition,{body:aD.condition});continue}if(ax&&!aD.alternative&&aw instanceof AST_Return&&aw.value){aj=true;aD=aD.clone();aD.alternative=aw;aC.splice(aB,1,aD.transform(at));aC.splice(aA,1);continue}if(ax&&!aD.alternative&&(!aw&&ao&&am||aw instanceof AST_Return)){aj=true;aD=aD.clone();aD.alternative=aw||c(AST_Return,aD,{value:null});aC.splice(aB,1,aD.transform(at));if(aw){aC.splice(aA,1)}continue}var av=aC[aE(aB)];if(at.option("sequences")&&ao&&!aD.alternative&&av instanceof AST_If&&av.body instanceof AST_Return&&aq(aA)==aC.length&&aw instanceof AST_SimpleStatement){aj=true;aD=aD.clone();aD.alternative=c(AST_BlockStatement,aw,{body:[aw,c(AST_Return,aw,{value:null})]});aC.splice(aB,1,aD.transform(at));aC.splice(aA,1);continue}}}function aG(aH){var aK=0;for(var aI=aH.length;--aI>=0;){var aJ=aH[aI];if(aJ instanceof AST_If&&aJ.body instanceof AST_Return){if(++aK>1){return true}}}return false}function ay(aH){return !aH||aH instanceof AST_UnaryPrefix&&aH.operator=="void"}function az(aI){if(!aI){return false}var aH=aI instanceof AST_LoopControl?at.loopcontrol_target(aI):null;return aI instanceof AST_Return&&ao&&ay(aI.value)||aI instanceof AST_Continue&&au===n(aH)||aI instanceof AST_Break&&aH instanceof AST_BlockStatement&&au===aH}function ap(){var aH=aC.slice(aB+1);aC.length=aB+1;return aH.filter(function(aI){if(aI instanceof AST_Defun){aC.push(aI);return false}return true})}function an(aI,aJ){var aH=C(aI).slice(0,-1);if(aJ.value){aH.push(c(AST_SimpleStatement,aJ.value,{body:aJ.value.expression}))}return aH}function aq(aJ){for(var aI=aJ+1,aH=aC.length;aI<aH;aI++){var aK=aC[aI];if(!(aK instanceof AST_Var&&ae(aK))){break}}return aI}function aE(aI){for(var aH=aI;--aH>=0;){var aJ=aC[aH];if(!(aJ instanceof AST_Var&&ae(aJ))){break}}return aH}}function al(ar,an){var aq;var au=an.self();for(var ap=0,am=0,at=ar.length;ap<at;ap++){var ao=ar[ap];if(ao instanceof AST_LoopControl){var av=an.loopcontrol_target(ao);if(ao instanceof AST_Break&&!(av instanceof AST_IterationStatement)&&n(av)===au||ao instanceof AST_Continue&&n(av)===au){if(ao.label){remove(ao.label.thedef.references,ao)}}else{ar[am++]=ao}}else{ar[am++]=ao}if(v(ao)){aq=ar.slice(ap+1);break}}ar.length=am;aj=am!=at;if(aq){aq.forEach(function(aw){G(an,aw,ar)})}}function ae(am){return all(am.definitions,function(an){return !an.value})}function ac(ar,an){if(ar.length<2){return}var av=[],am=0;function au(){if(!av.length){return}var aw=I(av[0],av);ar[am++]=c(AST_SimpleStatement,aw,{body:aw});av=[]}for(var ap=0,at=ar.length;ap<at;ap++){var ao=ar[ap];if(ao instanceof AST_SimpleStatement){if(av.length>=an.sequences_limit){au()}var aq=ao.body;if(av.length>0){aq=aq.drop_side_effect_free(an)}if(aq){d(av,aq)}}else{if(ao instanceof AST_Definitions&&ae(ao)||ao instanceof AST_Defun){ar[am++]=ao}else{au();ar[am++]=ao}}}au();ar.length=am;if(am!=at){aj=true}}function W(ar,ao){if(!(ar instanceof AST_BlockStatement)){return ar}var aq=null;for(var ap=0,am=ar.body.length;ap<am;ap++){var an=ar.body[ap];if(an instanceof AST_Var&&ae(an)){ao.push(an)}else{if(aq){return false}else{aq=an}}}return aq}function aa(ax,ap){function ao(az){am--;aj=true;var aA=an.body;return I(aA,[aA,az]).transform(ap)}var am=0,an;for(var at=0;at<ax.length;at++){var ar=ax[at];if(an){if(ar instanceof AST_Exit){ar.value=ao(ar.value||c(AST_Undefined,ar).transform(ap))}else{if(ar instanceof AST_For){if(!(ar.init instanceof AST_Definitions)){var aq=false;an.body.walk(new TreeWalker(function(az){if(aq||az instanceof AST_Scope){return true}if(az instanceof AST_Binary&&az.operator=="in"){aq=true;return true}}));if(!aq){if(ar.init){ar.init=ao(ar.init)}else{ar.init=an.body;am--;aj=true}}}}else{if(ar instanceof AST_ForIn){ar.object=ao(ar.object)}else{if(ar instanceof AST_If){ar.condition=ao(ar.condition)}else{if(ar instanceof AST_Switch){ar.expression=ao(ar.expression)}else{if(ar instanceof AST_With){ar.expression=ao(ar.expression)}}}}}}}if(ap.option("conditionals")&&ar instanceof AST_If){var ay=[];var av=W(ar.body,ay);var au=W(ar.alternative,ay);if(av!==false&&au!==false&&ay.length>0){var aw=ay.length;ay.push(c(AST_If,ar,{condition:ar.condition,body:av||c(AST_EmptyStatement,ar.body),alternative:au}));ay.unshift(am,1);[].splice.apply(ax,ay);at+=aw;am+=aw+1;an=null;aj=true;continue}}ax[am++]=ar;an=ar instanceof AST_SimpleStatement?ar:null}ax.length=am}function af(ap,am){var at;if(am instanceof AST_Assign){at=[am]}else{if(am instanceof AST_Sequence){at=am.expressions.slice()}}if(!at){return}if(ap instanceof AST_Definitions){var aq=ap.definitions[ap.definitions.length-1];if(ak(aq.name,aq.value,at)){return at}}for(var ao=at.length-1;--ao>=0;){var ar=at[ao];if(!(ar instanceof AST_Assign)){continue}if(ar.operator!="="){continue}if(!(ar.left instanceof AST_SymbolRef)){continue}var an=at.slice(ao+1);if(!ak(ar.left,ar.right,an)){continue}return at.slice(0,ao+1).concat(an)}}function ak(an,ap,at){if(!(ap instanceof AST_Object)){return}var ar=false;do{var ao=at[0];if(!(ao instanceof AST_Assign)){break}if(ao.operator!="="){break}if(!(ao.left instanceof AST_PropAccess)){break}var am=ao.left.expression;if(!(am instanceof AST_SymbolRef)){break}if(an.name!=am.name){break}if(!ao.right.is_constant_expression(V)){break}var au=ao.left.property;if(au instanceof AST_Node){au=au.evaluate(ad)}if(au instanceof AST_Node){break}au=""+au;var aq=ad.has_directive("use strict")?function(av){return av.key!=au&&av.key.name!=au}:function(av){return av.key.name!=au};if(!all(ap.properties,aq)){break}ap.properties.push(c(AST_ObjectKeyVal,ao,{key:au,value:ao.right}));at.shift();ar=true}while(at.length);return ar}function T(ar){var ao;for(var aq=0,an=-1,at=ar.length;aq<at;aq++){var ap=ar[aq];var am=ar[an];if(ap instanceof AST_Definitions){if(am&&am.TYPE==ap.TYPE){am.definitions=am.definitions.concat(ap.definitions);aj=true}else{if(ao&&ao.TYPE==ap.TYPE&&ae(ap)){ao.definitions=ao.definitions.concat(ap.definitions);aj=true}else{ar[++an]=ap;ao=ap}}}else{if(ap instanceof AST_Exit){ap.value=av(ap.value)}else{if(ap instanceof AST_For){var au=af(am,ap.init);if(au){aj=true;ap.init=au.length?I(ap.init,au):null;ar[++an]=ap}else{if(am instanceof AST_Var&&(!ap.init||ap.init.TYPE==am.TYPE)){if(ap.init){am.definitions=am.definitions.concat(ap.init.definitions)}ap.init=am;ar[an]=ap;aj=true}else{if(ao&&ap.init&&ao.TYPE==ap.init.TYPE&&ae(ap.init)){ao.definitions=ao.definitions.concat(ap.init.definitions);ap.init=null;ar[++an]=ap;aj=true}else{ar[++an]=ap}}}}else{if(ap instanceof AST_ForIn){ap.object=av(ap.object)}else{if(ap instanceof AST_If){ap.condition=av(ap.condition)}else{if(ap instanceof AST_SimpleStatement){var au=af(am,ap.body);if(au){aj=true;if(!au.length){continue}ap.body=I(ap.body,au)}ar[++an]=ap}else{if(ap instanceof AST_Switch){ap.expression=av(ap.expression)}else{if(ap instanceof AST_With){ap.expression=av(ap.expression)}else{ar[++an]=ap}}}}}}}}}ar.length=an+1;function av(aw){ar[++an]=ap;var ax=af(am,aw);if(ax){aj=true;if(ax.length){return I(aw,ax)}else{if(aw instanceof AST_Sequence){return aw.tail_node().left}else{return aw.left}}}return aw}}}function G(V,T,U){if(!(T instanceof AST_Defun)){V.warn("Dropping unreachable code [{file}:{line},{col}]",T.start)}T.walk(new TreeWalker(function(W){if(W instanceof AST_Definitions){V.warn("Declarations in unreachable code! [{file}:{line},{col}]",W.start);W.remove_initializers();U.push(W);return true}if(W instanceof AST_Defun){U.push(W);return true}if(W instanceof AST_Scope){return true}}))}function Q(T){if(T instanceof AST_Constant){return T.getValue()}if(T instanceof AST_UnaryPrefix&&T.operator=="void"&&T.expression instanceof AST_Constant){return}return T}function K(T,U){return T.is_undefined||T instanceof AST_Undefined||T instanceof AST_UnaryPrefix&&T.operator=="void"&&!T.expression.has_side_effects(U)}(function(T){T(AST_Node,return_false);T(AST_Array,return_true);T(AST_Assign,function(){return this.operator=="="&&this.right.is_truthy()});T(AST_Lambda,return_true);T(AST_Object,return_true);T(AST_RegExp,return_true);T(AST_Sequence,function(){return this.tail_node().is_truthy()});T(AST_SymbolRef,function(){var U=this.fixed_value();return U&&U.is_truthy()})})(function(U,T){U.DEFMETHOD("is_truthy",T)});(function(U){AST_Node.DEFMETHOD("may_throw_on_access",function(V){return !V.option("pure_getters")||this._dot_throw(V)});function T(V){return/strict/.test(V.option("pure_getters"))}U(AST_Node,T);U(AST_Null,return_true);U(AST_Undefined,return_true);U(AST_Constant,return_false);U(AST_Array,return_false);U(AST_Object,function(W){if(!T(W)){return false}for(var V=this.properties.length;--V>=0;){if(this.properties[V].value instanceof AST_Accessor){return true}}return false});U(AST_Lambda,return_false);U(AST_UnaryPostfix,return_false);U(AST_UnaryPrefix,function(){return this.operator=="void"});U(AST_Binary,function(V){return(this.operator=="&&"||this.operator=="||")&&(this.left._dot_throw(V)||this.right._dot_throw(V))});U(AST_Assign,function(V){return this.operator=="="&&this.right._dot_throw(V)});U(AST_Conditional,function(V){return this.consequent._dot_throw(V)||this.alternative._dot_throw(V)});U(AST_Dot,function(W){if(!T(W)){return false}var V=this.expression;if(V instanceof AST_SymbolRef){V=V.fixed_value()}return !(V instanceof AST_Lambda&&this.property=="prototype")});U(AST_Sequence,function(V){return this.tail_node()._dot_throw(V)});U(AST_SymbolRef,function(W){if(this.is_undefined){return true}if(!T(W)){return false}if(J(this)&&this.is_declared(W)){return false}if(this.is_immutable()){return false}var V=this.fixed_value();return !V||V._dot_throw(W)})})(function(U,T){U.DEFMETHOD("_dot_throw",T)});(function(U){var T=makePredicate("! delete");var V=makePredicate("in instanceof == != === !== < <= >= >");U(AST_Node,return_false);U(AST_UnaryPrefix,function(){return T[this.operator]});U(AST_Binary,function(){return V[this.operator]||j[this.operator]&&this.left.is_boolean()&&this.right.is_boolean()});U(AST_Conditional,function(){return this.consequent.is_boolean()&&this.alternative.is_boolean()});U(AST_Assign,function(){return this.operator=="="&&this.right.is_boolean()});U(AST_Sequence,function(){return this.tail_node().is_boolean()});U(AST_True,return_true);U(AST_False,return_true)})(function(U,T){U.DEFMETHOD("is_boolean",T)});(function(U){U(AST_Node,return_false);U(AST_Number,return_true);var T=makePredicate("+ - ~ ++ --");U(AST_Unary,function(){return T[this.operator]});var V=makePredicate("- * / % & | ^ << >> >>>");U(AST_Binary,function(W){return V[this.operator]||this.operator=="+"&&this.left.is_number(W)&&this.right.is_number(W)});U(AST_Assign,function(W){return V[this.operator.slice(0,-1)]||this.operator=="="&&this.right.is_number(W)});U(AST_Sequence,function(W){return this.tail_node().is_number(W)});U(AST_Conditional,function(W){return this.consequent.is_number(W)&&this.alternative.is_number(W)})})(function(U,T){U.DEFMETHOD("is_number",T)});(function(T){T(AST_Node,return_false);T(AST_String,return_true);T(AST_UnaryPrefix,function(){return this.operator=="typeof"});T(AST_Binary,function(U){return this.operator=="+"&&(this.left.is_string(U)||this.right.is_string(U))});T(AST_Assign,function(U){return(this.operator=="="||this.operator=="+=")&&this.right.is_string(U)});T(AST_Sequence,function(U){return this.tail_node().is_string(U)});T(AST_Conditional,function(U){return this.consequent.is_string(U)&&this.alternative.is_string(U)})})(function(U,T){U.DEFMETHOD("is_string",T)});var j=makePredicate("&& ||");var B=makePredicate("delete ++ --");function e(U,T){if(T instanceof AST_Unary&&B[T.operator]){return T.expression}if(T instanceof AST_Assign&&T.left===U){return U}}(function(U){AST_Node.DEFMETHOD("resolve_defines",function(Z){if(!Z.option("global_defs")){return}var X=this._find_defs(Z,"");if(X){var W,V=this,Y=0;do{W=V;V=Z.parent(Y++)}while(V instanceof AST_PropAccess&&V.expression===W);if(e(W,V)){Z.warn("global_defs "+this.print_to_string()+" redefined [{file}:{line},{col}]",this.start)}else{return X}}});function T(X,Y){if(X instanceof AST_Node){return c(X.CTOR,Y,X)}if(Array.isArray(X)){return c(AST_Array,Y,{elements:X.map(function(Z){return T(Z,Y)})})}if(X&&typeof X=="object"){var W=[];for(var V in X){if(HOP(X,V)){W.push(c(AST_ObjectKeyVal,Y,{key:V,value:T(X[V],Y)}))}}return c(AST_Object,Y,{properties:W})}return w(X,Y)}U(AST_Node,noop);U(AST_Dot,function(W,V){return this.expression._find_defs(W,"."+this.property+V)});U(AST_SymbolRef,function(aa,Z){if(!this.global()){return}var V;var W=aa.option("global_defs");if(W&&HOP(W,(V=this.name+Z))){var X=T(W[V],this);var Y=aa.find_parent(AST_Toplevel);X.walk(new TreeWalker(function(ab){if(ab instanceof AST_SymbolRef){ab.scope=Y;ab.thedef=Y.def_global(ab)}}));return X}})})(function(U,T){U.DEFMETHOD("_find_defs",T)});function a(U,T){return U.print_to_string().length>T.print_to_string().length?T:U}function r(U,T){return a(c(AST_SimpleStatement,U,{body:U}),c(AST_SimpleStatement,T,{body:T})).body}function l(V,U,T){return(first_in_statement(V)?r:a)(U,T)}function i(U){for(var T in U){U[T]=makePredicate(U[T])}}var L=["constructor","toString","valueOf"];var M={Array:["indexOf","join","lastIndexOf","slice"].concat(L),Boolean:L,Function:L,Number:["toExponential","toFixed","toPrecision"].concat(L),Object:L,RegExp:["test"].concat(L),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(L)};i(M);var q={Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode"]};i(q);(function(V){AST_Node.DEFMETHOD("evaluate",function(ab){if(!ab.option("evaluate")){return this}var Z=[];var aa=this._eval(ab,Z,1);Z.forEach(function(ac){delete ac._eval});if(!aa||aa instanceof RegExp){return aa}if(typeof aa=="function"||typeof aa=="object"){return this}return aa});var T=makePredicate("! ~ - + void");AST_Node.DEFMETHOD("is_constant",function(){if(this instanceof AST_Constant){return !(this instanceof AST_RegExp)}else{return this instanceof AST_UnaryPrefix&&this.expression instanceof AST_Constant&&T[this.operator]}});V(AST_Statement,function(){throw new Error(string_template("Cannot evaluate a statement [{file}:{line},{col}]",this.start))});V(AST_Lambda,return_this);V(AST_Node,return_this);V(AST_Constant,function(){return this.getValue()});V(AST_Function,function(aa){if(aa.option("unsafe")){var Z=function(){};Z.node=this;Z.toString=function(){return"function(){}"};return Z}return this});V(AST_Array,function(ag,ac,af){if(ag.option("unsafe")){var ae=[];for(var ab=0,Z=this.elements.length;ab<Z;ab++){var aa=this.elements[ab];var ad=aa._eval(ag,ac,af);if(aa===ad){return this}ae.push(ad)}return ae}return this});V(AST_Object,function(ag,ac,ae){if(ag.option("unsafe")){var ad={};for(var ab=0,Z=this.properties.length;ab<Z;ab++){var af=this.properties[ab];var aa=af.key;if(aa instanceof AST_Symbol){aa=aa.name}else{if(aa instanceof AST_Node){aa=aa._eval(ag,ac,ae);if(aa===af.key){return this}}}if(typeof Object.prototype[aa]==="function"){return this}if(af.value instanceof AST_Function){continue}ad[aa]=af.value._eval(ag,ac,ae);if(ad[aa]===af.value){return this}}return ad}return this});var W=makePredicate("! typeof void");V(AST_UnaryPrefix,function(ac,Z,ab){var aa=this.expression;if(ac.option("typeofs")&&this.operator=="typeof"&&(aa instanceof AST_Lambda||aa instanceof AST_SymbolRef&&aa.fixed_value() instanceof AST_Lambda)){return typeof function(){}}if(!W[this.operator]){ab++}aa=aa._eval(ac,Z,ab);if(aa===this.expression){return this}switch(this.operator){case"!":return !aa;case"typeof":if(aa instanceof RegExp){return this}return typeof aa;case"void":return void aa;case"~":return ~aa;case"-":return -aa;case"+":return +aa}return this});var Y=makePredicate("&& || === !==");V(AST_Binary,function(ae,ab,ad){if(!Y[this.operator]){ad++}var ac=this.left._eval(ae,ab,ad);if(ac===this.left){return this}var aa=this.right._eval(ae,ab,ad);if(aa===this.right){return this}var Z;switch(this.operator){case"&&":Z=ac&&aa;break;case"||":Z=ac||aa;break;case"|":Z=ac|aa;break;case"&":Z=ac&aa;break;case"^":Z=ac^aa;break;case"+":Z=ac+aa;break;case"*":Z=ac*aa;break;case"/":Z=ac/aa;break;case"%":Z=ac%aa;break;case"-":Z=ac-aa;break;case"<<":Z=ac<<aa;break;case">>":Z=ac>>aa;break;case">>>":Z=ac>>>aa;break;case"==":Z=ac==aa;break;case"===":Z=ac===aa;break;case"!=":Z=ac!=aa;break;case"!==":Z=ac!==aa;break;case"<":Z=ac<aa;break;case"<=":Z=ac<=aa;break;case">":Z=ac>aa;break;case">=":Z=ac>=aa;break;default:return this}if(isNaN(Z)&&ae.find_parent(AST_With)){return this}return Z});V(AST_Conditional,function(ae,Z,ac){var ad=this.condition._eval(ae,Z,ac);if(ad===this.condition){return this}var aa=ad?this.consequent:this.alternative;var ab=aa._eval(ae,Z,ac);return ab===aa?this:ab});V(AST_SymbolRef,function(ae,Z,ad){var aa=this.fixed_value();if(!aa){return this}var ab;if(Z.indexOf(aa)>=0){ab=aa._eval()}else{this._eval=return_this;ab=aa._eval(ae,Z,ad);delete this._eval;if(ab===aa){return this}aa._eval=function(){return ab};Z.push(aa)}if(ab&&typeof ab=="object"){var ac=this.definition().escaped;if(ac&&ad>ac){return this}}return ab});var X={Array:Array,Math:Math,Number:Number,Object:Object,String:String};var U={Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]};i(U);V(AST_PropAccess,function(af,ab,ae){if(af.option("unsafe")){var aa=this.property;if(aa instanceof AST_Node){aa=aa._eval(af,ab,ae);if(aa===this.property){return this}}var ad=this.expression;var ac;if(J(ad)){var Z=U[ad.name];if(!Z||!Z[aa]){return this}ac=X[ad.name]}else{ac=ad._eval(af,ab,ae+1);if(!ac||ac===ad||!HOP(ac,aa)){return this}if(typeof ac=="function"){switch(aa){case"name":return ac.node.name?ac.node.name.name:"";case"length":return ac.node.argnames.length;default:return this}}}return ac[aa]}return this});V(AST_Call,function(ae,ab,af){var ac=this.expression;if(ae.option("unsafe")&&ac instanceof AST_PropAccess){var am=ac.property;if(am instanceof AST_Node){am=am._eval(ae,ab,af);if(am===ac.property){return this}}var aa;var ah=ac.expression;if(J(ah)){var ak=q[ah.name];if(!ak||!ak[am]){return this}aa=X[ah.name]}else{aa=ah._eval(ae,ab,af+1);if(aa===ah||!aa){return this}var Z=M[aa.constructor.name];if(!Z||!Z[am]){return this}}var aj=[];for(var ad=0,ag=this.args.length;ad<ag;ad++){var an=this.args[ad];var al=an._eval(ae,ab,af);if(an===al){return this}aj.push(al)}try{return aa[am].apply(aa,aj)}catch(ai){ae.warn("Error evaluating {code} [{file}:{line},{col}]",{code:this.print_to_string(),file:this.start.file,line:this.start.line,col:this.start.col})}}return this});V(AST_New,return_this)})(function(U,T){U.DEFMETHOD("_eval",T)});(function(U){function T(W){return c(AST_UnaryPrefix,W,{operator:"!",expression:W})}function V(aa,Y,X){var Z=T(aa);if(X){var W=c(AST_SimpleStatement,Y,{body:Y});return a(Z,W)===W?Y:Z}return a(Z,Y)}U(AST_Node,function(){return T(this)});U(AST_Statement,function(){throw new Error("Cannot negate a statement")});U(AST_Function,function(){return T(this)});U(AST_UnaryPrefix,function(){if(this.operator=="!"){return this.expression}return T(this)});U(AST_Sequence,function(X){var W=this.expressions.slice();W.push(W.pop().negate(X));return I(this,W)});U(AST_Conditional,function(Y,X){var W=this.clone();W.consequent=W.consequent.negate(Y);W.alternative=W.alternative.negate(Y);return V(this,W,X)});U(AST_Binary,function(Z,X){var W=this.clone(),Y=this.operator;if(Z.option("unsafe_comps")){switch(Y){case"<=":W.operator=">";return W;case"<":W.operator=">=";return W;case">=":W.operator="<";return W;case">":W.operator="<=";return W}}switch(Y){case"==":W.operator="!=";return W;case"!=":W.operator="==";return W;case"===":W.operator="!==";return W;case"!==":W.operator="===";return W;case"&&":W.operator="||";W.left=W.left.negate(Z,X);W.right=W.right.negate(Z);return V(this,W,X);case"||":W.operator="&&";W.left=W.left.negate(Z,X);W.right=W.right.negate(Z);return V(this,W,X)}return T(this)})})(function(U,T){U.DEFMETHOD("negate",function(W,V){return T.call(this,W,V)})});var S=makePredicate("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError");AST_Call.DEFMETHOD("is_expr_pure",function(V){if(V.option("unsafe")){var U=this.expression;if(J(U)&&S[U.name]){return true}if(U instanceof AST_Dot&&J(U.expression)){var T=q[U.expression.name];return T&&T[U.property]}}return this.pure||!V.pure_funcs(this)});AST_Node.DEFMETHOD("is_call_pure",return_false);AST_Dot.DEFMETHOD("is_call_pure",function(V){if(!V.option("unsafe")){return}var U=this.expression;var T;if(U instanceof AST_Array){T=M.Array}else{if(U.is_boolean()){T=M.Boolean}else{if(U.is_number(V)){T=M.Number}else{if(U instanceof AST_RegExp){T=M.RegExp}else{if(U.is_string(V)){T=M.String}else{if(!this.may_throw_on_access(V)){T=M.Object}}}}}}return T&&T[this.property]});(function(U){U(AST_Node,return_true);U(AST_EmptyStatement,return_false);U(AST_Constant,return_false);U(AST_This,return_false);function T(W,X){for(var V=W.length;--V>=0;){if(W[V].has_side_effects(X)){return true}}return false}U(AST_Block,function(V){return T(this.body,V)});U(AST_Call,function(V){if(!this.is_expr_pure(V)&&(!this.expression.is_call_pure(V)||this.expression.has_side_effects(V))){return true}return T(this.args,V)});U(AST_Switch,function(V){return this.expression.has_side_effects(V)||T(this.body,V)});U(AST_Case,function(V){return this.expression.has_side_effects(V)||T(this.body,V)});U(AST_Try,function(V){return T(this.body,V)||this.bcatch&&this.bcatch.has_side_effects(V)||this.bfinally&&this.bfinally.has_side_effects(V)});U(AST_If,function(V){return this.condition.has_side_effects(V)||this.body&&this.body.has_side_effects(V)||this.alternative&&this.alternative.has_side_effects(V)});U(AST_LabeledStatement,function(V){return this.body.has_side_effects(V)});U(AST_SimpleStatement,function(V){return this.body.has_side_effects(V)});U(AST_Lambda,return_false);U(AST_Binary,function(V){return this.left.has_side_effects(V)||this.right.has_side_effects(V)});U(AST_Assign,return_true);U(AST_Conditional,function(V){return this.condition.has_side_effects(V)||this.consequent.has_side_effects(V)||this.alternative.has_side_effects(V)});U(AST_Unary,function(V){return B[this.operator]||this.expression.has_side_effects(V)});U(AST_SymbolRef,function(V){return !this.is_declared(V)});U(AST_SymbolDeclaration,return_false);U(AST_Object,function(V){return T(this.properties,V)});U(AST_ObjectProperty,function(V){return this.value.has_side_effects(V)});U(AST_Array,function(V){return T(this.elements,V)});U(AST_Dot,function(V){return this.expression.may_throw_on_access(V)||this.expression.has_side_effects(V)});U(AST_Sub,function(V){return this.expression.may_throw_on_access(V)||this.expression.has_side_effects(V)||this.property.has_side_effects(V)});U(AST_Sequence,function(V){return T(this.expressions,V)});U(AST_Definitions,function(V){return T(this.definitions,V)});U(AST_VarDef,function(V){return this.value})})(function(U,T){U.DEFMETHOD("has_side_effects",T)});(function(U){U(AST_Node,return_true);U(AST_Constant,return_false);U(AST_EmptyStatement,return_false);U(AST_Lambda,return_false);U(AST_SymbolDeclaration,return_false);U(AST_This,return_false);function T(W,X){for(var V=W.length;--V>=0;){if(W[V].may_throw(X)){return true}}return false}U(AST_Array,function(V){return T(this.elements,V)});U(AST_Assign,function(V){if(this.right.may_throw(V)){return true}if(!V.has_directive("use strict")&&this.operator=="="&&this.left instanceof AST_SymbolRef){return false}return this.left.may_throw(V)});U(AST_Binary,function(V){return this.left.may_throw(V)||this.right.may_throw(V)});U(AST_Block,function(V){return T(this.body,V)});U(AST_Call,function(V){if(T(this.args,V)){return true}if(this.is_expr_pure(V)){return false}if(this.expression.may_throw(V)){return true}return !(this.expression instanceof AST_Lambda)||T(this.expression.body,V)});U(AST_Case,function(V){return this.expression.may_throw(V)||T(this.body,V)});U(AST_Conditional,function(V){return this.condition.may_throw(V)||this.consequent.may_throw(V)||this.alternative.may_throw(V)});U(AST_Definitions,function(V){return T(this.definitions,V)});U(AST_Dot,function(V){return this.expression.may_throw_on_access(V)||this.expression.may_throw(V)});U(AST_If,function(V){return this.condition.may_throw(V)||this.body&&this.body.may_throw(V)||this.alternative&&this.alternative.may_throw(V)});U(AST_LabeledStatement,function(V){return this.body.may_throw(V)});U(AST_Object,function(V){return T(this.properties,V)});U(AST_ObjectProperty,function(V){return this.value.may_throw(V)});U(AST_Return,function(V){return this.value&&this.value.may_throw(V)});U(AST_Sequence,function(V){return T(this.expressions,V)});U(AST_SimpleStatement,function(V){return this.body.may_throw(V)});U(AST_Sub,function(V){return this.expression.may_throw_on_access(V)||this.expression.may_throw(V)||this.property.may_throw(V)});U(AST_Switch,function(V){return this.expression.may_throw(V)||T(this.body,V)});U(AST_SymbolRef,function(V){return !this.is_declared(V)});U(AST_Try,function(V){return this.bcatch?this.bcatch.may_throw(V):T(this.body,V)||this.bfinally&&this.bfinally.may_throw(V)});U(AST_Unary,function(V){if(this.operator=="typeof"&&this.expression instanceof AST_SymbolRef){return false}return this.expression.may_throw(V)});U(AST_VarDef,function(V){if(!this.value){return false}return this.value.may_throw(V)})})(function(U,T){U.DEFMETHOD("may_throw",T)});(function(U){function T(W){for(var V=W.length;--V>=0;){if(!W[V].is_constant_expression()){return false}}return true}U(AST_Node,return_false);U(AST_Constant,return_true);U(AST_Lambda,function(X){var W=this;var V=true;W.walk(new TreeWalker(function(Y){if(!V){return true}if(Y instanceof AST_SymbolRef){if(W.inlined){V=false;return true}var Z=Y.definition();if(member(Z,W.enclosed)&&!W.variables.has(Z.name)){if(X){var aa=X.find_variable(Y);if(Z.undeclared?!aa:aa===Z){V="f";return true}}V=false}return true}}));return V});U(AST_Unary,function(){return this.expression.is_constant_expression()});U(AST_Binary,function(){return this.left.is_constant_expression()&&this.right.is_constant_expression()});U(AST_Array,function(){return T(this.elements)});U(AST_Object,function(){return T(this.properties)});U(AST_ObjectProperty,function(){return this.value.is_constant_expression()})})(function(U,T){U.DEFMETHOD("is_constant_expression",T)});function v(T){return T&&T.aborts()}(function(T){T(AST_Statement,return_null);T(AST_Jump,return_this);function U(){var V=this.body.length;return V>0&&v(this.body[V-1])}T(AST_BlockStatement,U);T(AST_SwitchBranch,U);T(AST_If,function(){return this.alternative&&v(this.body)&&v(this.alternative)&&this})})(function(U,T){U.DEFMETHOD("aborts",T)});O(AST_Directive,function(T,U){if(U.has_directive(T.value)!==T){return c(AST_EmptyStatement,T)}return T});O(AST_Debugger,function(T,U){if(U.option("drop_debugger")){return c(AST_EmptyStatement,T)}return T});O(AST_LabeledStatement,function(T,U){if(T.body instanceof AST_Break&&U.loopcontrol_target(T.body)===T.body){return c(AST_EmptyStatement,T)}return T.label.references.length==0?T.body:T});O(AST_Block,function(T,U){z(T.body,U);return T});O(AST_BlockStatement,function(T,U){z(T.body,U);switch(T.body.length){case 1:return T.body[0];case 0:return c(AST_EmptyStatement,T)}return T});O(AST_Lambda,function(T,U){z(T.body,U);if(U.option("side_effects")&&T.body.length==1&&T.body[0]===U.has_directive("use strict")){T.body.length=0}return T});AST_Scope.DEFMETHOD("drop_unused",function(Z){if(!Z.option("unused")){return}if(Z.has_directive("use asm")){return}var aa=this;if(aa.pinned()){return}var am=!(aa instanceof AST_Toplevel)||Z.toplevel.funcs;var ai=!(aa instanceof AST_Toplevel)||Z.toplevel.vars;var ak=/keep_assign/.test(Z.option("unused"))?return_false:function(ap,ao){var an;if(ap instanceof AST_Assign&&(ap.write_only||ap.operator=="=")){an=ap.left}else{if(ap instanceof AST_Unary&&ap.write_only){an=ap.expression}}if(/strict/.test(Z.option("pure_getters"))){while(an instanceof AST_PropAccess&&!an.expression.may_throw_on_access(Z)){if(an instanceof AST_Sub){ao.unshift(an.property)}an=an.expression}}return an};var ab=[];var U=Object.create(null);var ac=Object.create(null);var V=Object.create(null);var ad=Object.create(null);if(aa instanceof AST_Toplevel&&Z.top_retain){aa.variables.each(function(an){if(Z.top_retain(an)&&!(an.id in U)){U[an.id]=true;ab.push(an)}})}var X=new Dictionary();var ae=new Dictionary();var W=this;var al=new TreeWalker(function(ao,an){if(ao===aa){return}if(ao instanceof AST_Defun){var ap=ao.name.definition();if(!am&&W===aa){if(!(ap.id in U)){U[ap.id]=true;ab.push(ap)}}ae.add(ap.id,ao);return true}if(ao instanceof AST_SymbolFunarg&&W===aa){X.add(ao.definition().id,ao)}if(ao instanceof AST_Definitions&&W===aa){ao.definitions.forEach(function(ar){var aq=ar.name.definition();if(ar.name instanceof AST_SymbolVar){X.add(aq.id,ar)}if(!ai){if(!(aq.id in U)){U[aq.id]=true;ab.push(aq)}}if(ar.value){ae.add(aq.id,ar.value);if(ar.value.has_side_effects(Z)){ar.value.walk(al)}if(!aq.chained&&ar.name.fixed_value()===ar.value){ac[aq.id]=ar}}});return true}return ah(ao,an)});aa.walk(al);al=new TreeWalker(ah);for(var ag=0;ag<ab.length;ag++){var af=ae.get(ab[ag].id);if(af){af.forEach(function(an){an.walk(al)})}}var T=new TreeTransformer(function Y(aA,ap,aB){var at=T.parent();if(ai){var an=[],av=ak(aA,an);if(av instanceof AST_SymbolRef){var aw=av.definition();var ay=aw.id in U;var az=null;if(aA instanceof AST_Assign){if(!ay||aA.left===av&&aw.id in ac&&ac[aw.id]!==aA){az=aA.right}}else{if(!ay){az=c(AST_Number,aA,{value:0})}}if(az){an.push(az);return f(Z,at,aA,I(aA,an.map(function(aH){return aH.transform(T)})))}}}if(W!==aa){return}if(aA instanceof AST_Function&&aA.name&&!Z.option("keep_fnames")){var aw=aA.name.definition();if(!(aw.id in U)||aw.orig.length>1){aA.name=null}}if(aA instanceof AST_Lambda&&!(aA instanceof AST_Accessor)){var aD=!Z.option("keep_fargs");for(var aF=aA.argnames,aC=aF.length;--aC>=0;){var av=aF[aC];if(!(av.definition().id in U)){av.__unused=true;if(aD){aF.pop();Z[av.unreferenced()?"warn":"info"]("Dropping unused function argument {name} [{file}:{line},{col}]",aG(av))}}else{aD=false}}}if(am&&aA instanceof AST_Defun&&aA!==aa){var aw=aA.name.definition();if(!(aw.id in U)){Z[aA.name.unreferenced()?"warn":"info"]("Dropping unused function {name} [{file}:{line},{col}]",aG(aA.name));aw.eliminated++;return c(AST_EmptyStatement,aA)}}if(aA instanceof AST_Definitions&&!(at instanceof AST_ForIn&&at.init===aA)){var au=[],ao=[],aq=[];var ax=[];aA.definitions.forEach(function(aM){if(aM.value){aM.value=aM.value.transform(T)}var aI=aM.name.definition();if(!ai||aI.id in U){if(aM.value&&aI.id in ac&&ac[aI.id]!==aM){aM.value=aM.value.drop_side_effect_free(Z)}if(aM.name instanceof AST_SymbolVar){var aK=X.get(aI.id);if(aK.length>1&&(!aM.value||aI.orig.indexOf(aM.name)>aI.eliminated)){Z.warn("Dropping duplicated definition of variable {name} [{file}:{line},{col}]",aG(aM.name));if(aM.value){var aJ=c(AST_SymbolRef,aM.name,aM.name);aI.references.push(aJ);var aH=c(AST_Assign,aM,{operator:"=",left:aJ,right:aM.value});if(ac[aI.id]===aM){ac[aI.id]=aH}ax.push(aH.transform(T))}remove(aK,aM);aI.eliminated++;return}}if(aM.value){if(ax.length>0){if(aq.length>0){ax.push(aM.value);aM.value=I(aM.value,ax)}else{au.push(c(AST_SimpleStatement,aA,{body:I(aA,ax)}))}ax=[]}aq.push(aM)}else{ao.push(aM)}}else{if(aI.orig[0] instanceof AST_SymbolCatch){var aL=aM.value&&aM.value.drop_side_effect_free(Z);if(aL){ax.push(aL)}aM.value=null;ao.push(aM)}else{var aL=aM.value&&aM.value.drop_side_effect_free(Z);if(aL){Z.warn("Side effects in initialization of unused variable {name} [{file}:{line},{col}]",aG(aM.name));ax.push(aL)}else{Z[aM.name.unreferenced()?"warn":"info"]("Dropping unused variable {name} [{file}:{line},{col}]",aG(aM.name))}aI.eliminated++}}});if(ao.length>0||aq.length>0){aA.definitions=ao.concat(aq);au.push(aA)}if(ax.length>0){au.push(c(AST_SimpleStatement,aA,{body:I(aA,ax)}))}switch(au.length){case 0:return aB?MAP.skip:c(AST_EmptyStatement,aA);case 1:return au[0];default:return aB?MAP.splice(au):c(AST_BlockStatement,aA,{body:au})}}if(aA instanceof AST_For){ap(aA,this);var ar;if(aA.init instanceof AST_BlockStatement){ar=aA.init;aA.init=ar.body.pop();ar.body.push(aA)}if(aA.init instanceof AST_SimpleStatement){aA.init=aA.init.body}else{if(x(aA.init)){aA.init=null}}return !ar?aA:aB?MAP.splice(ar.body):ar}if(aA instanceof AST_LabeledStatement&&aA.body instanceof AST_For){ap(aA,this);if(aA.body instanceof AST_BlockStatement){var ar=aA.body;aA.body=ar.body.pop();ar.body.push(aA);return aB?MAP.splice(ar.body):ar}return aA}if(aA instanceof AST_Scope){var aE=W;W=aA;ap(aA,this);W=aE;return aA}function aG(aH){return{name:aH.name,file:aH.start.file,line:aH.start.line,col:aH.start.col}}});aa.transform(T);function aj(ap,ao,an){if(ap.id in U){return}if(ao&&an){U[ap.id]=true;ab.push(ap)}else{V[ap.id]=ao;ad[ap.id]=an}}function ah(at,aq){var au,ap=[],an=ak(at,ap);if(an instanceof AST_SymbolRef&&aa.variables.get(an.name)===(au=an.definition())){ap.forEach(function(av){av.walk(al)});if(at instanceof AST_Assign){at.right.walk(al);if(at.left===an){if(!au.chained&&an.fixed_value()===at.right){ac[au.id]=at}if(!at.write_only){aj(au,true,ad[au.id])}}else{var ar=an.fixed_value();if(!ar||!ar.is_constant()){aj(au,V[au.id],true)}}}return true}if(at instanceof AST_SymbolRef){au=at.definition();if(!(au.id in U)){U[au.id]=true;ab.push(au)}return true}if(at instanceof AST_Scope){var ao=W;W=at;aq();W=ao;return true}}});AST_Scope.DEFMETHOD("hoist_declarations",function(ab){var ae=this;if(ab.has_directive("use asm")){return ae}var ah=ab.option("hoist_funs");var X=ab.option("hoist_vars");if(ah||X){var W=[];var ai=[];var af=new Dictionary(),ad=0,Y=0;ae.walk(new TreeWalker(function(al){if(al instanceof AST_Scope&&al!==ae){return true}if(al instanceof AST_Var){++Y;return true}}));X=X&&Y>1;var T=new TreeTransformer(function aa(am){if(am!==ae){if(am instanceof AST_Directive){W.push(am);return c(AST_EmptyStatement,am)}if(ah&&am instanceof AST_Defun&&(T.parent()===ae||!ab.has_directive("use strict"))){ai.push(am);return c(AST_EmptyStatement,am)}if(X&&am instanceof AST_Var){am.definitions.forEach(function(ap){af.set(ap.name.name,ap);++ad});var al=am.to_assignments(ab);var ao=T.parent();if(ao instanceof AST_ForIn&&ao.init===am){if(al==null){var an=am.definitions[0].name;return c(AST_SymbolRef,an,an)}return al}if(ao instanceof AST_For&&ao.init===am){return al}if(!al){return c(AST_EmptyStatement,am)}return c(AST_SimpleStatement,am,{body:al})}if(am instanceof AST_Scope){return am}}});ae=ae.transform(T);if(ad>0){var U=[];af.each(function(am,al){if(ae instanceof AST_Lambda&&!all(ae.argnames,function(an){return an.name!=al})){af.del(al)}else{am=am.clone();am.value=null;U.push(am);af.set(al,am)}});if(U.length>0){for(var aj=0;aj<ae.body.length;){if(ae.body[aj] instanceof AST_SimpleStatement){var V=ae.body[aj].body,Z,ag;if(V instanceof AST_Assign&&V.operator=="="&&(Z=V.left) instanceof AST_Symbol&&af.has(Z.name)){var ac=af.get(Z.name);if(ac.value){break}ac.value=V.right;remove(U,ac);U.push(ac);ae.body.splice(aj,1);continue}if(V instanceof AST_Sequence&&(ag=V.expressions[0]) instanceof AST_Assign&&ag.operator=="="&&(Z=ag.left) instanceof AST_Symbol&&af.has(Z.name)){var ac=af.get(Z.name);if(ac.value){break}ac.value=ag.right;remove(U,ac);U.push(ac);ae.body[aj].body=I(V,V.expressions.slice(1));continue}}if(ae.body[aj] instanceof AST_EmptyStatement){ae.body.splice(aj,1);continue}if(ae.body[aj] instanceof AST_BlockStatement){var ak=[aj,1].concat(ae.body[aj].body);ae.body.splice.apply(ae.body,ak);continue}break}U=c(AST_Var,ae,{definitions:U});ai.push(U)}}ae.body=W.concat(ai,ae.body)}return ae});AST_Scope.DEFMETHOD("var_names",function(){var T=this._var_names;if(!T){this._var_names=T=Object.create(null);this.enclosed.forEach(function(U){T[U.name]=true});this.variables.each(function(V,U){T[U]=true})}return T});AST_Scope.DEFMETHOD("make_var_name",function(V){var W=this.var_names();V=V.replace(/(?:^[^a-z_$]|[^a-z0-9_$])/ig,"_");var T=V;for(var U=0;W[T];U++){T=V+"$"+U}W[T]=true;return T});AST_Scope.DEFMETHOD("hoist_properties",function(W){var T=this;if(!W.option("hoist_props")||W.has_directive("use asm")){return T}var U=T instanceof AST_Toplevel&&W.top_retain||return_false;var V=Object.create(null);return T.transform(new TreeTransformer(function(ab,af){if(ab instanceof AST_Assign&&ab.operator=="="&&ab.write_only&&Y(ab.left,ab.right,1)){af(ab,this);var ac=new Dictionary();var X=[];var ag=[];ab.right.properties.forEach(function(aj){var ah=ae(ab.left,aj.key);ag.push(c(AST_VarDef,ab,{name:ah,value:null}));var ai=c(AST_SymbolRef,ab,{name:ah.name,scope:T,thedef:ah.definition()});ai.reference({});X.push(c(AST_Assign,ab,{operator:"=",left:ai,right:aj.value}))});V[ab.left.definition().id]=ac;T.body.splice(T.body.indexOf(this.stack[1])+1,0,c(AST_Var,ab,{definitions:ag}));return I(ab,X)}if(ab instanceof AST_VarDef&&Y(ab.name,ab.value,0)){af(ab,this);var ac=new Dictionary();var ad=[];ab.value.properties.forEach(function(ah){ad.push(c(AST_VarDef,ab,{name:ae(ab.name,ah.key),value:ah.value}))});V[ab.name.definition().id]=ac;return MAP.splice(ad)}if(ab instanceof AST_PropAccess&&ab.expression instanceof AST_SymbolRef){var ac=V[ab.expression.definition().id];if(ac){var Z=ac.get(Q(ab.property));var aa=c(AST_SymbolRef,ab,{name:Z.name,scope:ab.expression.scope,thedef:Z});aa.reference({});return aa}}function Y(ah,ai,aj){if(ah.scope!==T){return}var ak=ah.definition();if(ak.assignments!=aj){return}if(ak.direct_access){return}if(ak.escaped==1){return}if(ak.single_use){return}if(U(ak)){return}if(ah.fixed_value()!==ai){return}return ai instanceof AST_Object}function ae(ah,ai){var aj=c(AST_SymbolVar,ah,{name:T.make_var_name(ah.name+"_"+ai),scope:T});var ak=T.def_variable(aj);ac.set(ai,ak);T.enclosed.push(ak);return aj}}))});(function(U){function T(W,ac,aa){var V=W.length;if(!V){return null}var X=[],ab=false;for(var Y=0;Y<V;Y++){var Z=W[Y].drop_side_effect_free(ac,aa);ab|=Z!==W[Y];if(Z){X.push(Z);aa=false}}return ab?X.length?X:null:W}U(AST_Node,return_this);U(AST_Constant,return_null);U(AST_This,return_null);U(AST_Call,function(aa,X){if(!this.is_expr_pure(aa)){if(this.expression.is_call_pure(aa)){var Z=this.args.slice();Z.unshift(this.expression.expression);Z=T(Z,aa,X);return Z&&I(this,Z)}if(this.expression instanceof AST_Function&&(!this.expression.name||!this.expression.name.definition().references.length)){var W=this.clone();var Y=W.expression;Y.process_expression(false,aa);Y.walk(new TreeWalker(function(ab){if(ab instanceof AST_Return&&ab.value){ab.value=ab.value.drop_side_effect_free(aa);return true}if(ab instanceof AST_Scope&&ab!==Y){return true}}));return W}return this}if(this.pure){aa.warn("Dropping __PURE__ call [{file}:{line},{col}]",this.start)}var V=T(this.args,aa,X);return V&&I(this,V)});U(AST_Accessor,return_null);U(AST_Function,return_null);U(AST_Binary,function(Z,X){var V=this.right.drop_side_effect_free(Z);if(!V){return this.left.drop_side_effect_free(Z,X)}if(j[this.operator]){if(V===this.right){return this}var W=this.clone();W.right=V;return W}else{var Y=this.left.drop_side_effect_free(Z,X);if(!Y){return this.right.drop_side_effect_free(Z,X)}return I(this,[Y,V])}});U(AST_Assign,function(W){var V=this.left;if(V.has_side_effects(W)||W.has_directive("use strict")&&V instanceof AST_PropAccess&&V.expression.is_constant()){return this}this.write_only=true;if(m(V).is_constant_expression(W.find_parent(AST_Scope))){return this.right.drop_side_effect_free(W)}return this});U(AST_Conditional,function(Y){var X=this.consequent.drop_side_effect_free(Y);var V=this.alternative.drop_side_effect_free(Y);if(X===this.consequent&&V===this.alternative){return this}if(!X){return V?c(AST_Binary,this,{operator:"||",left:this.condition,right:V}):this.condition.drop_side_effect_free(Y)}if(!V){return c(AST_Binary,this,{operator:"&&",left:this.condition,right:X})}var W=this.clone();W.consequent=X;W.alternative=V;return W});U(AST_Unary,function(X,V){if(B[this.operator]){this.write_only=!this.expression.has_side_effects(X);return this}if(this.operator=="typeof"&&this.expression instanceof AST_SymbolRef){return null}var W=this.expression.drop_side_effect_free(X,V);if(V&&W&&P(W)){if(W===this.expression&&this.operator=="!"){return this}return W.negate(X,V)}return W});U(AST_SymbolRef,function(V){return this.is_declared(V)?null:this});U(AST_Object,function(X,W){var V=T(this.properties,X,W);return V&&I(this,V)});U(AST_ObjectProperty,function(W,V){return this.value.drop_side_effect_free(W,V)});U(AST_Array,function(X,W){var V=T(this.elements,X,W);return V&&I(this,V)});U(AST_Dot,function(W,V){if(this.expression.may_throw_on_access(W)){return this}return this.expression.drop_side_effect_free(W,V)});U(AST_Sub,function(Y,W){if(this.expression.may_throw_on_access(Y)){return this}var X=this.expression.drop_side_effect_free(Y,W);if(!X){return this.property.drop_side_effect_free(Y,W)}var V=this.property.drop_side_effect_free(Y);if(!V){return X}return I(this,[X,V])});U(AST_Sequence,function(Y){var W=this.tail_node();var X=W.drop_side_effect_free(Y);if(X===W){return this}var V=this.expressions.slice(0,-1);if(X){V.push(X)}return I(this,V)})})(function(U,T){U.DEFMETHOD("drop_side_effect_free",T)});O(AST_SimpleStatement,function(U,W){if(W.option("side_effects")){var T=U.body;var V=T.drop_side_effect_free(W,true);if(!V){W.warn("Dropping side-effect-free statement [{file}:{line},{col}]",U.start);return c(AST_EmptyStatement,U)}if(V!==T){return c(AST_SimpleStatement,U,{body:V})}}return U});O(AST_While,function(T,U){return U.option("loops")?c(AST_For,T,T).optimize(U):T});function F(T,V){var W=false;var U=new TreeWalker(function(X){if(W||X instanceof AST_Scope){return true}if(X instanceof AST_LoopControl&&U.loopcontrol_target(X)===T){return W=true}});if(V instanceof AST_LabeledStatement){U.push(V)}U.push(T);T.body.walk(U);return W}O(AST_Do,function(T,V){if(!V.option("loops")){return T}var U=T.condition.is_truthy()||T.condition.tail_node().evaluate(V);if(!(U instanceof AST_Node)){if(U){return c(AST_For,T,{body:c(AST_BlockStatement,T.body,{body:[T.body,c(AST_SimpleStatement,T.condition,{body:T.condition})]})}).optimize(V)}if(!F(T,V.parent())){return c(AST_BlockStatement,T.body,{body:[T.body,c(AST_SimpleStatement,T.condition,{body:T.condition})]}).optimize(V)}}if(T.body instanceof AST_SimpleStatement){return c(AST_For,T,{condition:I(T.condition,[T.body.body,T.condition]),body:c(AST_EmptyStatement,T)}).optimize(V)}return T});function g(V,Y){var X=V.body instanceof AST_BlockStatement?V.body.body[0]:V.body;if(Y.option("dead_code")&&T(X)){var U=[];if(V.init instanceof AST_Statement){U.push(V.init)}else{if(V.init){U.push(c(AST_SimpleStatement,V.init,{body:V.init}))}}if(V.condition){U.push(c(AST_SimpleStatement,V.condition,{body:V.condition}))}G(Y,V.body,U);return c(AST_BlockStatement,V,{body:U})}if(X instanceof AST_If){if(T(X.body)){if(V.condition){V.condition=c(AST_Binary,V.condition,{left:V.condition,operator:"&&",right:X.condition.negate(Y)})}else{V.condition=X.condition.negate(Y)}W(X.alternative)}else{if(T(X.alternative)){if(V.condition){V.condition=c(AST_Binary,V.condition,{left:V.condition,operator:"&&",right:X.condition})}else{V.condition=X.condition}W(X.body)}}}return V;function T(Z){return Z instanceof AST_Break&&Y.loopcontrol_target(Z)===Y.self()}function W(Z){Z=C(Z);if(V.body instanceof AST_BlockStatement){V.body=V.body.clone();V.body.body=Z.concat(V.body.body.slice(1));V.body=V.body.transform(Y)}else{V.body=c(AST_BlockStatement,V.body,{body:Z}).transform(Y)}V=g(V,Y)}}O(AST_For,function(U,X){if(!X.option("loops")){return U}if(X.option("side_effects")&&U.init){U.init=U.init.drop_side_effect_free(X)}if(U.condition){var V=U.condition.evaluate(X);if(!(V instanceof AST_Node)){if(V){U.condition=null}else{if(!X.option("dead_code")){var W=U.condition;U.condition=w(V,U.condition);U.condition=a(U.condition.transform(X),W)}}}if(V instanceof AST_Node){V=U.condition.is_truthy()||U.condition.tail_node().evaluate(X)}if(!V){if(X.option("dead_code")){var T=[];G(X,U.body,T);if(U.init instanceof AST_Statement){T.push(U.init)}else{if(U.init){T.push(c(AST_SimpleStatement,U.init,{body:U.init}))}}T.push(c(AST_SimpleStatement,U.condition,{body:U.condition}));return c(AST_BlockStatement,U,{body:T}).optimize(X)}}else{if(U.condition&&!(V instanceof AST_Node)){U.body=c(AST_BlockStatement,U.body,{body:[c(AST_SimpleStatement,U.condition,{body:U.condition}),U.body]});U.condition=null}}}return g(U,X)});O(AST_If,function(ad,X){if(x(ad.alternative)){ad.alternative=null}if(!X.option("conditionals")){return ad}var aa=ad.condition.evaluate(X);if(!X.option("dead_code")&&!(aa instanceof AST_Node)){var ab=ad.condition;ad.condition=w(aa,ab);ad.condition=a(ad.condition.transform(X),ab)}if(X.option("dead_code")){if(aa instanceof AST_Node){aa=ad.condition.is_truthy()||ad.condition.tail_node().evaluate(X)}if(!aa){X.warn("Condition always false [{file}:{line},{col}]",ad.condition.start);var Z=[];G(X,ad.body,Z);Z.push(c(AST_SimpleStatement,ad.condition,{body:ad.condition}));if(ad.alternative){Z.push(ad.alternative)}return c(AST_BlockStatement,ad,{body:Z}).optimize(X)}else{if(!(aa instanceof AST_Node)){X.warn("Condition always true [{file}:{line},{col}]",ad.condition.start);var Z=[];if(ad.alternative){G(X,ad.alternative,Z)}Z.push(c(AST_SimpleStatement,ad.condition,{body:ad.condition}));Z.push(ad.body);return c(AST_BlockStatement,ad,{body:Z}).optimize(X)}}}var T=ad.condition.negate(X);var U=ad.condition.print_to_string().length;var ac=T.print_to_string().length;var V=ac<U;if(ad.alternative&&V){V=false;ad.condition=T;var W=ad.body;ad.body=ad.alternative||c(AST_EmptyStatement,ad);ad.alternative=W}if(x(ad.body)&&x(ad.alternative)){return c(AST_SimpleStatement,ad.condition,{body:ad.condition.clone()}).optimize(X)}if(ad.body instanceof AST_SimpleStatement&&ad.alternative instanceof AST_SimpleStatement){return c(AST_SimpleStatement,ad,{body:c(AST_Conditional,ad,{condition:ad.condition,consequent:ad.body.body,alternative:ad.alternative.body})}).optimize(X)}if(x(ad.alternative)&&ad.body instanceof AST_SimpleStatement){if(U===ac&&!V&&ad.condition instanceof AST_Binary&&ad.condition.operator=="||"){V=true}if(V){return c(AST_SimpleStatement,ad,{body:c(AST_Binary,ad,{operator:"||",left:T,right:ad.body.body})}).optimize(X)}return c(AST_SimpleStatement,ad,{body:c(AST_Binary,ad,{operator:"&&",left:ad.condition,right:ad.body.body})}).optimize(X)}if(ad.body instanceof AST_EmptyStatement&&ad.alternative instanceof AST_SimpleStatement){return c(AST_SimpleStatement,ad,{body:c(AST_Binary,ad,{operator:"||",left:ad.condition,right:ad.alternative.body})}).optimize(X)}if(ad.body instanceof AST_Exit&&ad.alternative instanceof AST_Exit&&ad.body.TYPE==ad.alternative.TYPE){return c(ad.body.CTOR,ad,{value:c(AST_Conditional,ad,{condition:ad.condition,consequent:ad.body.value||c(AST_Undefined,ad.body),alternative:ad.alternative.value||c(AST_Undefined,ad.alternative)}).transform(X)}).optimize(X)}if(ad.body instanceof AST_If&&!ad.body.alternative&&!ad.alternative){ad=c(AST_If,ad,{condition:c(AST_Binary,ad.condition,{operator:"&&",left:ad.condition,right:ad.body.condition}),body:ad.body.body,alternative:null})}if(v(ad.body)){if(ad.alternative){var Y=ad.alternative;ad.alternative=null;return c(AST_BlockStatement,ad,{body:[ad,Y]}).optimize(X)}}if(v(ad.alternative)){var Z=ad.body;ad.body=ad.alternative;ad.condition=V?T:ad.condition.negate(X);ad.alternative=null;return c(AST_BlockStatement,ad,{body:[ad,Z]}).optimize(X)}return ad});O(AST_Switch,function(ac,aa){if(!aa.option("switches")){return ac}var T;var ag=ac.expression.evaluate(aa);if(!(ag instanceof AST_Node)){var V=ac.expression;ac.expression=w(ag,V);ac.expression=a(ac.expression.transform(aa),V)}if(!aa.option("dead_code")){return ac}if(ag instanceof AST_Node){ag=ac.expression.tail_node().evaluate(aa)}var W=[];var Z=[];var ad;var U;for(var ah=0,ai=ac.body.length;ah<ai&&!U;ah++){T=ac.body[ah];if(T instanceof AST_Default){if(!ad){ad=T}else{X(T,Z[Z.length-1])}}else{if(!(ag instanceof AST_Node)){var Y=T.expression.evaluate(aa);if(!(Y instanceof AST_Node)&&Y!==ag){X(T,Z[Z.length-1]);continue}if(Y instanceof AST_Node){Y=T.expression.tail_node().evaluate(aa)}if(Y===ag){U=T;if(ad){var ab=Z.indexOf(ad);Z.splice(ab,1);X(ad,Z[ab-1]);ad=null}}}}if(v(T)){var ae=Z[Z.length-1];if(v(ae)&&ae.body.length==T.body.length&&c(AST_BlockStatement,ae,ae).equivalent_to(c(AST_BlockStatement,T,T))){ae.body=[]}}Z.push(T)}while(ah<ai){X(ac.body[ah++],Z[Z.length-1])}if(Z.length>0){Z[0].body=W.concat(Z[0].body)}ac.body=Z;while(T=Z[Z.length-1]){var ak=T.body[T.body.length-1];if(ak instanceof AST_Break&&aa.loopcontrol_target(ak)===ac){T.body.pop()}if(T.body.length||T instanceof AST_Case&&(ad||T.expression.has_side_effects(aa))){break}if(Z.pop()===ad){ad=null}}if(Z.length==0){return c(AST_BlockStatement,ac,{body:W.concat(c(AST_SimpleStatement,ac.expression,{body:ac.expression}))}).optimize(aa)}if(Z.length==1&&(Z[0]===U||Z[0]===ad)){var af=false;var al=new TreeWalker(function(am){if(af||am instanceof AST_Lambda||am instanceof AST_SimpleStatement){return true}if(am instanceof AST_Break&&al.loopcontrol_target(am)===ac){af=true}});ac.walk(al);if(!af){var aj=Z[0].body.slice();var Y=Z[0].expression;if(Y){aj.unshift(c(AST_SimpleStatement,Y,{body:Y}))}aj.unshift(c(AST_SimpleStatement,ac.expression,{body:ac.expression}));return c(AST_BlockStatement,ac,{body:aj}).optimize(aa)}}return ac;function X(am,an){if(an&&!v(an)){an.body=an.body.concat(am.body)}else{G(aa,am,W)}}});O(AST_Try,function(U,V){z(U.body,V);if(U.bcatch&&U.bfinally&&all(U.bfinally.body,x)){U.bfinally=null}if(V.option("dead_code")&&all(U.body,x)){var T=[];if(U.bcatch){G(V,U.bcatch,T);T.forEach(function(W){if(!(W instanceof AST_Definitions)){return}W.definitions.forEach(function(Y){var X=Y.name.definition().redefined();if(!X){return}Y.name=Y.name.clone();Y.name.thedef=X})})}if(U.bfinally){T=T.concat(U.bfinally.body)}return c(AST_BlockStatement,U,{body:T}).optimize(V)}return U});AST_Definitions.DEFMETHOD("remove_initializers",function(){this.definitions.forEach(function(T){T.value=null})});AST_Definitions.DEFMETHOD("to_assignments",function(V){var U=V.option("reduce_vars");var T=this.definitions.reduce(function(W,Y){if(Y.value){var X=c(AST_SymbolRef,Y.name,Y.name);W.push(c(AST_Assign,Y,{operator:"=",left:X,right:Y.value}));if(U){X.definition().fixed=false}}Y=Y.name.definition();Y.eliminated++;Y.replaced--;return W},[]);if(T.length==0){return null}return I(this,T)});O(AST_Definitions,function(T,U){if(T.definitions.length==0){return c(AST_EmptyStatement,T)}return T});AST_Call.DEFMETHOD("lift_sequences",function(X){if(!X.option("sequences")){return this}var W=this.expression;if(!(W instanceof AST_Sequence)){return this}var T=W.tail_node();if(p(X,T)&&!(this instanceof AST_New)){return this}var V=W.expressions.slice(0,-1);var U=this.clone();U.expression=T;V.push(U);return I(this,V).optimize(X)});O(AST_Call,function(ad,ai){var aq=ad.lift_sequences(ai);if(aq!==ad){return aq}var aK=ad.expression;var at=aK;if(ai.option("reduce_vars")&&at instanceof AST_SymbolRef){at=at.fixed_value()}var aL=at instanceof AST_Lambda;if(ai.option("unused")&&aL&&!at.uses_arguments&&!at.pinned()){var aw=0,aj=0;for(var aI=0,ak=ad.args.length;aI<ak;aI++){var T=aI>=at.argnames.length;if(T||at.argnames[aI].__unused){var ax=ad.args[aI].drop_side_effect_free(ai);if(ax){ad.args[aw++]=ax}else{if(!T){ad.args[aw++]=c(AST_Number,ad.args[aI],{value:0});continue}}}else{ad.args[aw++]=ad.args[aI]}aj=aw}ad.args.length=aj}if(ai.option("unsafe")){if(J(aK)){switch(aK.name){case"Array":if(ad.args.length!=1){return c(AST_Array,ad,{elements:ad.args}).optimize(ai)}break;case"Object":if(ad.args.length==0){return c(AST_Object,ad,{properties:[]})}break;case"String":if(ad.args.length==0){return c(AST_String,ad,{value:""})}if(ad.args.length<=1){return c(AST_Binary,ad,{left:ad.args[0],operator:"+",right:c(AST_String,ad,{value:""})}).optimize(ai)}break;case"Number":if(ad.args.length==0){return c(AST_Number,ad,{value:0})}if(ad.args.length==1){return c(AST_UnaryPrefix,ad,{expression:ad.args[0],operator:"+"}).optimize(ai)}case"Boolean":if(ad.args.length==0){return c(AST_False,ad)}if(ad.args.length==1){return c(AST_UnaryPrefix,ad,{expression:c(AST_UnaryPrefix,ad,{expression:ad.args[0],operator:"!"}),operator:"!"}).optimize(ai)}break;case"RegExp":var W=[];if(all(ad.args,function(aN){var aO=aN.evaluate(ai);W.unshift(aO);return aN!==aO})){try{return l(ai,ad,c(AST_RegExp,ad,{value:RegExp.apply(RegExp,W)}))}catch(aC){ai.warn("Error converting {expr} [{file}:{line},{col}]",{expr:ad.print_to_string(),file:ad.start.file,line:ad.start.line,col:ad.start.col})}}break}}else{if(aK instanceof AST_Dot){switch(aK.property){case"toString":if(ad.args.length==0&&!aK.expression.may_throw_on_access(ai)){return c(AST_Binary,ad,{left:c(AST_String,ad,{value:""}),operator:"+",right:aK.expression}).optimize(ai)}break;case"join":if(aK.expression instanceof AST_Array){EXIT:{var aM;if(ad.args.length>0){aM=ad.args[0].evaluate(ai);if(aM===ad.args[0]){break EXIT}}var ab=[];var ap=[];aK.expression.elements.forEach(function(aN){var aO=aN.evaluate(ai);if(aO!==aN){ap.push(aO)}else{if(ap.length>0){ab.push(c(AST_String,ad,{value:ap.join(aM)}));ap.length=0}ab.push(aN)}});if(ap.length>0){ab.push(c(AST_String,ad,{value:ap.join(aM)}))}if(ab.length==0){return c(AST_String,ad,{value:""})}if(ab.length==1){if(ab[0].is_string(ai)){return ab[0]}return c(AST_Binary,ab[0],{operator:"+",left:c(AST_String,ad,{value:""}),right:ab[0]})}if(aM==""){var ae;if(ab[0].is_string(ai)||ab[1].is_string(ai)){ae=ab.shift()}else{ae=c(AST_String,ad,{value:""})}return ab.reduce(function(aO,aN){return c(AST_Binary,aN,{operator:"+",left:aO,right:aN})},ae).optimize(ai)}var ax=ad.clone();ax.expression=ax.expression.clone();ax.expression.expression=ax.expression.expression.clone();ax.expression.expression.elements=ab;return l(ai,ad,ax)}}break;case"charAt":if(aK.expression.is_string(ai)){var ao=ad.args[0];var ay=ao?ao.evaluate(ai):0;if(ay!==ao){return c(AST_Sub,aK,{expression:aK.expression,property:w(ay|0,ao||aK)}).optimize(ai)}}break;case"apply":if(ad.args.length==2&&ad.args[1] instanceof AST_Array){var aG=ad.args[1].elements.slice();aG.unshift(ad.args[0]);return c(AST_Call,ad,{expression:c(AST_Dot,aK,{expression:aK.expression,property:"call"}),args:aG}).optimize(ai)}break;case"call":var am=aK.expression;if(am instanceof AST_SymbolRef){am=am.fixed_value()}if(am instanceof AST_Lambda&&!am.contains_this()){return(ad.args.length?I(this,[ad.args[0],c(AST_Call,ad,{expression:aK.expression,args:ad.args.slice(1)})]):c(AST_Call,ad,{expression:aK.expression,args:[]})).optimize(ai)}break}}}}if(ai.option("unsafe_Function")&&J(aK)&&aK.name=="Function"){if(ad.args.length==0){return c(AST_Function,ad,{argnames:[],body:[]})}if(all(ad.args,function(aN){return aN instanceof AST_String})){try{var Z="n(function("+ad.args.slice(0,-1).map(function(aN){return aN.value}).join(",")+"){"+ad.args[ad.args.length-1].value+"})";var U=parse(Z);var az={ie8:ai.option("ie8")};U.figure_out_scope(az);var X=new Compressor(ai.options);U=U.transform(X);U.figure_out_scope(az);U.compute_char_frequency(az);U.mangle_names(az);var aH;U.walk(new TreeWalker(function(aN){if(aH){return true}if(aN instanceof AST_Lambda){aH=aN;return true}}));var Z=OutputStream();AST_BlockStatement.prototype._codegen.call(aH,aH,Z);ad.args=[c(AST_String,ad,{value:aH.argnames.map(function(aN){return aN.print_to_string()}).join(",")}),c(AST_String,ad.args[ad.args.length-1],{value:Z.get().replace(/^\{|\}$/g,"")})];return ad}catch(aC){if(aC instanceof JS_Parse_Error){ai.warn("Error parsing code passed to new Function [{file}:{line},{col}]",ad.args[ad.args.length-1].start);ai.warn(aC.toString())}else{throw aC}}}}var aJ=aL&&at.body[0];var Y=ai.option("inline")&&!ad.is_expr_pure(ai);if(Y&&aJ instanceof AST_Return){var aD=aJ.value;if(!aD||aD.is_constant_expression()){if(aD){aD=aD.clone(true)}else{aD=c(AST_Undefined,ad)}var aG=ad.args.concat(aD);return I(ad,aG).optimize(ai)}}if(aL){var al,aD,aA,aa,ac=-1;if(Y&&!at.uses_arguments&&!at.pinned()&&!(at.name&&at instanceof AST_Function)&&(aD=ar(aJ))&&(aK===at||ai.option("unused")&&(al=aK.definition()).references.length==1&&!D(ai,al)&&at.is_constant_expression(aK.scope))&&!ad.pure&&!at.contains_this()&&aE()){at._squeezed=true;return I(ad,V()).optimize(ai)}if(ai.option("side_effects")&&all(at.body,x)){var aG=ad.args.concat(c(AST_Undefined,ad));return I(ad,aG).optimize(ai)}}if(ai.option("drop_console")){if(aK instanceof AST_PropAccess){var ah=aK.expression;while(ah.expression){ah=ah.expression}if(J(ah)&&ah.name=="console"){return c(AST_Undefined,ad).optimize(ai)}}}if(ai.option("negate_iife")&&ai.parent() instanceof AST_SimpleStatement&&P(ad)){return ad.negate(ai,true)}var aF=ad.evaluate(ai);if(aF!==ad){aF=w(aF,ad).optimize(ai);return l(ai,aF,ad)}return ad;function an(aN){if(!aN){return c(AST_Undefined,ad)}if(aN instanceof AST_Return){if(!aN.value){return c(AST_Undefined,ad)}return aN.value.clone(true)}if(aN instanceof AST_SimpleStatement){return c(AST_UnaryPrefix,aN,{operator:"void",expression:aN.body.clone(true)})}}function ar(aQ){var aN=at.body.length;if(ai.option("inline")<3){return aN==1&&an(aQ)}aQ=null;for(var aP=0;aP<aN;aP++){var aO=at.body[aP];if(aO instanceof AST_Var){if(aQ&&!all(aO.definitions,function(aR){return !aR.value})){return false}}else{if(aO instanceof AST_EmptyStatement){continue}else{if(aQ){return false}else{aQ=aO}}}}return an(aQ)}function ag(aP,aR){for(var aQ=0,aO=at.argnames.length;aQ<aO;aQ++){var aN=at.argnames[aQ];if(aN.__unused){continue}if(!aR||aP[aN.name]||t[aN.name]||aA.var_names()[aN.name]){return false}if(aa){aa.push(aN.definition())}}return true}function af(aO,aT){var aN=at.body.length;for(var aR=0;aR<aN;aR++){var aS=at.body[aR];if(!(aS instanceof AST_Var)){continue}if(!aT){return false}for(var aQ=aS.definitions.length;--aQ>=0;){var aP=aS.definitions[aQ].name;if(aO[aP.name]||t[aP.name]||aA.var_names()[aP.name]){return false}if(aa){aa.push(aP.definition())}}}return true}function aE(){var aN=Object.create(null);do{aA=ai.parent(++ac);if(aA instanceof AST_Catch){aN[aA.argname.name]=true}else{if(aA instanceof AST_IterationStatement){aa=[]}else{if(aA instanceof AST_SymbolRef){if(aA.fixed_value() instanceof AST_Scope){return false}}}}}while(!(aA instanceof AST_Scope));var aP=!(aA instanceof AST_Toplevel)||ai.toplevel.vars;var aO=ai.option("inline");if(!af(aN,aO>=3&&aP)){return false}if(!ag(aN,aO>=2&&aP)){return false}return !aa||aa.length==0||!b(at,aa)}function aB(aN,aQ,aP,aS){var aR=aP.definition();aA.variables.set(aP.name,aR);aA.enclosed.push(aR);if(!aA.var_names()[aP.name]){aA.var_names()[aP.name]=true;aN.push(c(AST_VarDef,aP,{name:aP,value:null}))}var aO=c(AST_SymbolRef,aP,aP);aR.references.push(aO);if(aS){aQ.push(c(AST_Assign,ad,{operator:"=",left:aO,right:aS}))}}function av(aO,aR){var aN=at.argnames.length;for(var aQ=ad.args.length;--aQ>=aN;){aR.push(ad.args[aQ])}for(aQ=aN;--aQ>=0;){var aP=at.argnames[aQ];var aT=ad.args[aQ];if(aP.__unused||aA.var_names()[aP.name]){if(aT){aR.push(aT)}}else{var aS=c(AST_SymbolVar,aP,aP);aP.definition().orig.push(aS);if(!aT&&aa){aT=c(AST_Undefined,ad)}aB(aO,aR,aS,aT)}}aO.reverse();aR.reverse()}function au(aY,aV){var aW=aV.length;for(var aU=0,aZ=at.body.length;aU<aZ;aU++){var aT=at.body[aU];if(!(aT instanceof AST_Var)){continue}for(var aR=0,aS=aT.definitions.length;aR<aS;aR++){var aQ=aT.definitions[aR];var aN=aQ.name;var aX=aN.definition().redefined();if(aX){aN=aN.clone();aN.thedef=aX}aB(aY,aV,aN,aQ.value);if(aa&&all(at.argnames,function(a0){return a0.name!=aN.name})){var aP=at.variables.get(aN.name);var aO=c(AST_SymbolRef,aN,aN);aP.references.push(aO);aV.splice(aW++,0,c(AST_Assign,aQ,{operator:"=",left:aO,right:c(AST_Undefined,aN)}))}}}}function V(){var aN=[];var aO=[];av(aN,aO);au(aN,aO);aO.push(aD);if(aN.length){aI=aA.body.indexOf(ai.parent(ac-1))+1;aA.body.splice(aI,0,c(AST_Var,at,{definitions:aN}))}return aO}});O(AST_New,function(U,W){var T=U.lift_sequences(W);if(T!==U){return T}if(W.option("unsafe")){var V=U.expression;if(J(V)){switch(V.name){case"Object":case"RegExp":case"Function":case"Error":case"Array":return c(AST_Call,U,U).transform(W)}}}return U});O(AST_Sequence,function(U,Y){if(!Y.option("side_effects")){return U}var X=[];V();var T=X.length-1;W();if(T==0){U=f(Y,Y.parent(),Y.self(),X[0]);if(!(U instanceof AST_Sequence)){U=U.optimize(Y)}return U}U.expressions=X;return U;function V(){var aa=first_in_statement(Y);var Z=U.expressions.length-1;U.expressions.forEach(function(ac,ab){if(ab<Z){ac=ac.drop_side_effect_free(Y,aa)}if(ac){d(X,ac);aa=false}})}function W(){while(T>0&&K(X[T],Y)){T--}if(T<X.length-1){X[T]=c(AST_UnaryPrefix,U,{operator:"void",expression:X[T]});X.length=T+1}}});AST_Unary.DEFMETHOD("lift_sequences",function(V){if(V.option("sequences")&&this.expression instanceof AST_Sequence){var T=this.expression.expressions.slice();var U=this.clone();U.expression=T.pop();T.push(U);return I(this,T).optimize(V)}return this});O(AST_UnaryPostfix,function(T,U){return T.lift_sequences(U)});O(AST_UnaryPrefix,function(U,X){var W=U.expression;if(U.operator=="delete"&&!(W instanceof AST_SymbolRef||W instanceof AST_PropAccess||s(W))){if(W instanceof AST_Sequence){W=W.expressions.slice();W.push(c(AST_True,U));return I(U,W).optimize(X)}return I(U,[W,c(AST_True,U)]).optimize(X)}var T=U.lift_sequences(X);if(T!==U){return T}if(X.option("side_effects")&&U.operator=="void"){W=W.drop_side_effect_free(X);if(W){U.expression=W;return U}else{return c(AST_Undefined,U).optimize(X)}}if(X.option("booleans")){if(U.operator=="!"&&W.is_truthy()){return I(U,[W,c(AST_False,U)]).optimize(X)}else{if(X.in_boolean_context()){switch(U.operator){case"!":if(W instanceof AST_UnaryPrefix&&W.operator=="!"){return W.expression}if(W instanceof AST_Binary){U=l(X,U,W.negate(X,first_in_statement(X)))}break;case"typeof":X.warn("Boolean expression always true [{file}:{line},{col}]",U.start);return(W instanceof AST_SymbolRef?c(AST_True,U):I(U,[W,c(AST_True,U)])).optimize(X)}}}}if(U.operator=="-"&&W instanceof AST_Infinity){W=W.transform(X)}if(W instanceof AST_Binary&&(U.operator=="+"||U.operator=="-")&&(W.operator=="*"||W.operator=="/"||W.operator=="%")){return c(AST_Binary,U,{operator:W.operator,left:c(AST_UnaryPrefix,W.left,{operator:U.operator,expression:W.left}),right:W.right})}if(U.operator!="-"||!(W instanceof AST_Number||W instanceof AST_Infinity)){var V=U.evaluate(X);if(V!==U){V=w(V,U).optimize(X);return l(X,V,U)}}return U});AST_Binary.DEFMETHOD("lift_sequences",function(Y){if(Y.option("sequences")){if(this.left instanceof AST_Sequence){var T=this.left.expressions.slice();var X=this.clone();X.left=T.pop();T.push(X);return I(this,T).optimize(Y)}if(this.right instanceof AST_Sequence&&!this.left.has_side_effects(Y)){var U=this.operator=="="&&this.left instanceof AST_SymbolRef;var T=this.right.expressions;var W=T.length-1;for(var V=0;V<W;V++){if(!U&&T[V].has_side_effects(Y)){break}}if(V==W){T=T.slice();var X=this.clone();X.right=T.pop();T.push(X);return I(this,T).optimize(Y)}else{if(V>0){var X=this.clone();X.right=I(this.right,T.slice(V));T=T.slice(0,V);T.push(X);return I(this,T).optimize(Y)}}}}return this});var u=makePredicate("== === != !== * & | ^");function E(T){return T instanceof AST_Array||T instanceof AST_Lambda||T instanceof AST_Object}O(AST_Binary,function(aj,aa){function U(){return aj.left.is_constant()||aj.right.is_constant()||!aj.left.has_side_effects(aa)&&!aj.right.has_side_effects(aa)}function ad(al){if(U()){if(al){aj.operator=al}var ak=aj.left;aj.left=aj.right;aj.right=ak}}if(u[aj.operator]){if(aj.right.is_constant()&&!aj.left.is_constant()){if(!(aj.left instanceof AST_Binary&&PRECEDENCE[aj.left.operator]>=PRECEDENCE[aj.operator])){ad()}}}aj=aj.lift_sequences(aa);if(aa.option("comparisons")){switch(aj.operator){case"===":case"!==":var ai=true;if((aj.left.is_string(aa)&&aj.right.is_string(aa))||(aj.left.is_number(aa)&&aj.right.is_number(aa))||(aj.left.is_boolean()&&aj.right.is_boolean())||aj.left.equivalent_to(aj.right)){aj.operator=aj.operator.substr(0,2)}case"==":case"!=":if(!ai&&K(aj.left,aa)){aj.left=c(AST_Null,aj.left)}else{if(aa.option("typeofs")&&aj.left instanceof AST_String&&aj.left.value=="undefined"&&aj.right instanceof AST_UnaryPrefix&&aj.right.operator=="typeof"){var ah=aj.right.expression;if(ah instanceof AST_SymbolRef?ah.is_declared(aa):!(ah instanceof AST_PropAccess&&aa.option("ie8"))){aj.right=ah;aj.left=c(AST_Undefined,aj.left).optimize(aa);if(aj.operator.length==2){aj.operator+="="}}}else{if(aj.left instanceof AST_SymbolRef&&aj.right instanceof AST_SymbolRef&&aj.left.definition()===aj.right.definition()&&E(aj.left.fixed_value())){return c(aj.operator[0]=="="?AST_True:AST_False,aj)}}}break;case"&&":case"||":var W=aj.left;if(W.operator==aj.operator){W=W.right}if(W instanceof AST_Binary&&W.operator==(aj.operator=="&&"?"!==":"===")&&aj.right instanceof AST_Binary&&W.operator==aj.right.operator&&(K(W.left,aa)&&aj.right.left instanceof AST_Null||W.left instanceof AST_Null&&K(aj.right.left,aa))&&!W.right.has_side_effects(aa)&&W.right.equivalent_to(aj.right.right)){var X=c(AST_Binary,aj,{operator:W.operator.slice(0,-1),left:c(AST_Null,aj),right:W.right});if(W!==aj.left){X=c(AST_Binary,aj,{operator:aj.operator,left:aj.left.left,right:X})}return X}break}}if(aa.option("booleans")&&aj.operator=="+"&&aa.in_boolean_context()){var af=aj.left.evaluate(aa);var Y=aj.right.evaluate(aa);if(af&&typeof af=="string"){aa.warn("+ in boolean context always true [{file}:{line},{col}]",aj.start);return I(aj,[aj.right,c(AST_True,aj)]).optimize(aa)}if(Y&&typeof Y=="string"){aa.warn("+ in boolean context always true [{file}:{line},{col}]",aj.start);return I(aj,[aj.left,c(AST_True,aj)]).optimize(aa)}}if(aa.option("comparisons")&&aj.is_boolean()){if(!(aa.parent() instanceof AST_Binary)||aa.parent() instanceof AST_Assign){var T=c(AST_UnaryPrefix,aj,{operator:"!",expression:aj.negate(aa,first_in_statement(aa))});aj=l(aa,aj,T)}switch(aj.operator){case">":ad("<");break;case">=":ad("<=");break}}if(aj.operator=="+"){if(aj.right instanceof AST_String&&aj.right.getValue()==""&&aj.left.is_string(aa)){return aj.left}if(aj.left instanceof AST_String&&aj.left.getValue()==""&&aj.right.is_string(aa)){return aj.right}if(aj.left instanceof AST_Binary&&aj.left.operator=="+"&&aj.left.left instanceof AST_String&&aj.left.left.getValue()==""&&aj.right.is_string(aa)){aj.left=aj.left.right;return aj.transform(aa)}}if(aa.option("evaluate")){switch(aj.operator){case"&&":var af=ac(aj.left);if(!af){aa.warn("Condition left of && always false [{file}:{line},{col}]",aj.start);return f(aa,aa.parent(),aa.self(),aj.left).optimize(aa)}else{if(!(af instanceof AST_Node)){aa.warn("Condition left of && always true [{file}:{line},{col}]",aj.start);return I(aj,[aj.left,aj.right]).optimize(aa)}}var Y=aj.right.evaluate(aa);if(!Y){if(aa.option("booleans")&&aa.in_boolean_context()){aa.warn("Boolean && always false [{file}:{line},{col}]",aj.start);return I(aj,[aj.left,c(AST_False,aj)]).optimize(aa)}else{aj.falsy=true}}else{if(!(Y instanceof AST_Node)){var ag=aa.parent();if(ag.operator=="&&"&&ag.left===aa.self()||aa.option("booleans")&&aa.in_boolean_context()){aa.warn("Dropping side-effect-free && [{file}:{line},{col}]",aj.start);return aj.left.optimize(aa)}}}if(aj.left.operator=="||"){var ab=aj.left.right.evaluate(aa);if(!ab){return c(AST_Conditional,aj,{condition:aj.left.left,consequent:aj.right,alternative:aj.left.right}).optimize(aa)}}break;case"||":var af=ac(aj.left);if(!af){aa.warn("Condition left of || always false [{file}:{line},{col}]",aj.start);return I(aj,[aj.left,aj.right]).optimize(aa)}else{if(!(af instanceof AST_Node)){aa.warn("Condition left of || always true [{file}:{line},{col}]",aj.start);return f(aa,aa.parent(),aa.self(),aj.left).optimize(aa)}}var Y=aj.right.evaluate(aa);if(!Y){var ag=aa.parent();if(ag.operator=="||"&&ag.left===aa.self()||aa.option("booleans")&&aa.in_boolean_context()){aa.warn("Dropping side-effect-free || [{file}:{line},{col}]",aj.start);return aj.left.optimize(aa)}}else{if(!(Y instanceof AST_Node)){if(aa.option("booleans")&&aa.in_boolean_context()){aa.warn("Boolean || always true [{file}:{line},{col}]",aj.start);return I(aj,[aj.left,c(AST_True,aj)]).optimize(aa)}else{aj.truthy=true}}}if(aj.left.operator=="&&"){var ab=aj.left.right.evaluate(aa);if(ab&&!(ab instanceof AST_Node)){return c(AST_Conditional,aj,{condition:aj.left.left,consequent:aj.left.right,alternative:aj.right}).optimize(aa)}}break}var V=true;switch(aj.operator){case"+":if(aj.left instanceof AST_Constant&&aj.right instanceof AST_Binary&&aj.right.operator=="+"&&aj.right.left instanceof AST_Constant&&aj.right.is_string(aa)){aj=c(AST_Binary,aj,{operator:"+",left:c(AST_String,aj.left,{value:""+aj.left.getValue()+aj.right.left.getValue(),start:aj.left.start,end:aj.right.left.end}),right:aj.right.right})}if(aj.right instanceof AST_Constant&&aj.left instanceof AST_Binary&&aj.left.operator=="+"&&aj.left.right instanceof AST_Constant&&aj.left.is_string(aa)){aj=c(AST_Binary,aj,{operator:"+",left:aj.left.left,right:c(AST_String,aj.right,{value:""+aj.left.right.getValue()+aj.right.getValue(),start:aj.left.right.start,end:aj.right.end})})}if(aj.left instanceof AST_Binary&&aj.left.operator=="+"&&aj.left.is_string(aa)&&aj.left.right instanceof AST_Constant&&aj.right instanceof AST_Binary&&aj.right.operator=="+"&&aj.right.left instanceof AST_Constant&&aj.right.is_string(aa)){aj=c(AST_Binary,aj,{operator:"+",left:c(AST_Binary,aj.left,{operator:"+",left:aj.left.left,right:c(AST_String,aj.left.right,{value:""+aj.left.right.getValue()+aj.right.left.getValue(),start:aj.left.right.start,end:aj.right.left.end})}),right:aj.right.right})}if(aj.right instanceof AST_UnaryPrefix&&aj.right.operator=="-"&&aj.left.is_number(aa)){aj=c(AST_Binary,aj,{operator:"-",left:aj.left,right:aj.right.expression});break}if(aj.left instanceof AST_UnaryPrefix&&aj.left.operator=="-"&&U()&&aj.right.is_number(aa)){aj=c(AST_Binary,aj,{operator:"-",left:aj.right,right:aj.left.expression});break}case"*":V=aa.option("unsafe_math");case"&":case"|":case"^":if(aj.left.is_number(aa)&&aj.right.is_number(aa)&&U()&&!(aj.left instanceof AST_Binary&&aj.left.operator!=aj.operator&&PRECEDENCE[aj.left.operator]>=PRECEDENCE[aj.operator])){var Z=c(AST_Binary,aj,{operator:aj.operator,left:aj.right,right:aj.left});if(aj.right instanceof AST_Constant&&!(aj.left instanceof AST_Constant)){aj=l(aa,Z,aj)}else{aj=l(aa,aj,Z)}}if(V&&aj.is_number(aa)){if(aj.right instanceof AST_Binary&&aj.right.operator==aj.operator){aj=c(AST_Binary,aj,{operator:aj.operator,left:c(AST_Binary,aj.left,{operator:aj.operator,left:aj.left,right:aj.right.left,start:aj.left.start,end:aj.right.left.end}),right:aj.right.right})}if(aj.right instanceof AST_Constant&&aj.left instanceof AST_Binary&&aj.left.operator==aj.operator){if(aj.left.left instanceof AST_Constant){aj=c(AST_Binary,aj,{operator:aj.operator,left:c(AST_Binary,aj.left,{operator:aj.operator,left:aj.left.left,right:aj.right,start:aj.left.left.start,end:aj.right.end}),right:aj.left.right})}else{if(aj.left.right instanceof AST_Constant){aj=c(AST_Binary,aj,{operator:aj.operator,left:c(AST_Binary,aj.left,{operator:aj.operator,left:aj.left.right,right:aj.right,start:aj.left.right.start,end:aj.right.end}),right:aj.left.left})}}}if(aj.left instanceof AST_Binary&&aj.left.operator==aj.operator&&aj.left.right instanceof AST_Constant&&aj.right instanceof AST_Binary&&aj.right.operator==aj.operator&&aj.right.left instanceof AST_Constant){aj=c(AST_Binary,aj,{operator:aj.operator,left:c(AST_Binary,aj.left,{operator:aj.operator,left:c(AST_Binary,aj.left.left,{operator:aj.operator,left:aj.left.right,right:aj.right.left,start:aj.left.right.start,end:aj.right.left.end}),right:aj.left.left}),right:aj.right.right})}}}}if(aj.right instanceof AST_Binary&&aj.right.operator==aj.operator&&(j[aj.operator]||(aj.operator=="+"&&(aj.right.left.is_string(aa)||(aj.left.is_string(aa)&&aj.right.right.is_string(aa)))))){aj.left=c(AST_Binary,aj.left,{operator:aj.operator,left:aj.left,right:aj.right.left});aj.right=aj.right.right;return aj.transform(aa)}var ae=aj.evaluate(aa);if(ae!==aj){ae=w(ae,aj).optimize(aa);return l(aa,ae,aj)}return aj;function ac(ak){if(ak.truthy){return true}if(ak.falsy){return false}if(ak.is_truthy()){return true}return ak.evaluate(aa)}});function D(X,W){var V;for(var U=0;V=X.parent(U);U++){if(V instanceof AST_Lambda){var T=V.name;if(T&&T.definition()===W){break}}}return V}O(AST_SymbolRef,function(af,ad){var ae=af.resolve_defines(ad);if(ae){return ae.optimize(ad)}if(!ad.option("ie8")&&J(af)&&(!af.scope.uses_with||!ad.find_parent(AST_With))){switch(af.name){case"undefined":return c(AST_Undefined,af).optimize(ad);case"NaN":return c(AST_NaN,af).optimize(ad);case"Infinity":return c(AST_Infinity,af).optimize(ad)}}var ab=ad.parent();if(ad.option("reduce_vars")&&e(af,ab)!==af){var ak=af.definition();var W=af.fixed_value();var X=ak.single_use&&!(ab instanceof AST_Call&&ab.is_expr_pure(ad));if(X&&W instanceof AST_Lambda){if(ak.scope!==af.scope&&(!ad.option("reduce_funcs")||ak.escaped==1||W.inlined)){X=false}else{if(D(ad,ak)){X=false}else{if(ak.scope!==af.scope||ak.orig[0] instanceof AST_SymbolFunarg){X=W.is_constant_expression(af.scope);if(X=="f"){var T=af.scope;do{if(T instanceof AST_Defun||T instanceof AST_Function){T.inlined=true}}while(T=T.parent_scope)}}}}}if(X&&W){if(W instanceof AST_Defun){W._squeezed=true;W=c(AST_Function,W,W)}var ag;if(ak.recursive_refs>0&&W.name instanceof AST_SymbolDefun){ag=W.clone(true);var aa=ag.name.definition();var V=ag.variables.get(ag.name.name);var al=V&&V.orig[0];if(!(al instanceof AST_SymbolLambda)){al=c(AST_SymbolLambda,ag.name,ag.name);al.scope=ag;ag.name=al;V=ag.def_function(al)}ag.walk(new TreeWalker(function(am){if(am instanceof AST_SymbolRef&&am.definition()===aa){am.thedef=V;V.references.push(am)}}))}else{ag=W.optimize(ad);if(ag===W){ag=W.clone(true)}}return ag}if(W&&ak.should_replace===undefined){var ai;if(W instanceof AST_This){if(!(ak.orig[0] instanceof AST_SymbolFunarg)&&all(ak.references,function(am){return ak.scope===am.scope})){ai=W}}else{var aj=W.evaluate(ad);if(aj!==W&&(ad.option("unsafe_regexp")||!(aj instanceof RegExp))){ai=w(aj,W)}}if(ai){var Z=ai.optimize(ad).print_to_string().length;var Y;if(ac(W)){Y=function(){var am=ai.optimize(ad);return am===ai?am.clone(true):am}}else{Z=Math.min(Z,W.print_to_string().length);Y=function(){var am=a(ai.optimize(ad),W);return am===ai||am===W?am.clone(true):am}}var U=ak.name.length;var ah=0;if(ad.option("unused")&&!ad.exposed(ak)){ah=(U+2+Z)/(ak.references.length-ak.assignments)}ak.should_replace=Z<=U+ah?Y:false}else{ak.should_replace=false}}if(ak.should_replace){return ak.should_replace()}}return af;function ac(an){var am;an.walk(new TreeWalker(function(ao){if(ao instanceof AST_SymbolRef){am=true}if(am){return true}}));return am}});function R(T,U){return T instanceof AST_SymbolRef||T.TYPE===U.TYPE}O(AST_Undefined,function(U,X){if(X.option("unsafe_undefined")){var V=h(X,"undefined");if(V){var W=c(AST_SymbolRef,U,{name:"undefined",scope:V.scope,thedef:V});W.is_undefined=true;return W}}var T=e(X.self(),X.parent());if(T&&R(T,U)){return U}return c(AST_UnaryPrefix,U,{operator:"void",expression:c(AST_Number,U,{value:0})})});O(AST_Infinity,function(U,V){var T=e(V.self(),V.parent());if(T&&R(T,U)){return U}if(V.option("keep_infinity")&&!(T&&!R(T,U))&&!h(V,"Infinity")){return U}return c(AST_Binary,U,{operator:"/",left:c(AST_Number,U,{value:1}),right:c(AST_Number,U,{value:0})})});O(AST_NaN,function(U,V){var T=e(V.self(),V.parent());if(T&&!R(T,U)||h(V,"NaN")){return c(AST_Binary,U,{operator:"/",left:c(AST_Number,U,{value:0}),right:c(AST_Number,U,{value:0})})}return U});function b(U,T){var W=false;var X=new TreeWalker(function(Y){if(W){return true}if(Y instanceof AST_SymbolRef&&member(Y.definition(),T)){return W=true}});var V=new TreeWalker(function(Z){if(W){return true}if(Z instanceof AST_Scope&&Z!==U){var Y=V.parent();if(Y instanceof AST_Call&&Y.expression===Z){return}Z.walk(X);return true}});U.walk(V);return W}var A=makePredicate("+ - / * % >> << >>> | ^ &");var k=makePredicate("* | ^ &");O(AST_Assign,function(U,Z){var X;if(Z.option("dead_code")&&U.left instanceof AST_SymbolRef&&(X=U.left.definition()).scope===Z.find_parent(AST_Lambda)){var Y=0,W,V=U;do{W=V;V=Z.parent(Y++);if(V instanceof AST_Exit){if(T(Y,V)){break}if(b(X.scope,[X])){break}if(U.operator=="="){return U.right}X.fixed=false;return c(AST_Binary,U,{operator:U.operator.slice(0,-1),left:U.left,right:U.right}).optimize(Z)}}while(V instanceof AST_Binary&&V.right===W||V instanceof AST_Sequence&&V.tail_node()===W)}U=U.lift_sequences(Z);if(U.operator=="="&&U.left instanceof AST_SymbolRef&&U.right instanceof AST_Binary){if(U.right.left instanceof AST_SymbolRef&&U.right.left.name==U.left.name&&A[U.right.operator]){U.operator=U.right.operator+"=";U.right=U.right.right}else{if(U.right.right instanceof AST_SymbolRef&&U.right.right.name==U.left.name&&k[U.right.operator]&&!U.right.left.has_side_effects(Z)){U.operator=U.right.operator+"=";U.right=U.right.left}}}return U;function T(af,ae){var ab=U.right;U.right=c(AST_Null,ab);var aa=ae.may_throw(Z);U.right=ab;var ad=U.left.definition().scope;var ac;while((ac=Z.parent(af++))!==ad){if(ac instanceof AST_Try){if(ac.bfinally){return true}if(aa&&ac.bcatch){return true}}}}});O(AST_Conditional,function(ah,Z){if(!Z.option("conditionals")){return ah}if(ah.condition instanceof AST_Sequence){var ab=ah.condition.expressions.slice();ah.condition=ab.pop();ab.push(ah);return I(ah,ab)}var af=ah.condition.is_truthy()||ah.condition.tail_node().evaluate(Z);if(!af){Z.warn("Condition always false [{file}:{line},{col}]",ah.start);return I(ah,[ah.condition,ah.alternative]).optimize(Z)}else{if(!(af instanceof AST_Node)){Z.warn("Condition always true [{file}:{line},{col}]",ah.start);return I(ah,[ah.condition,ah.consequent]).optimize(Z)}}var T=af.negate(Z,first_in_statement(Z));if(l(Z,af,T)===T){ah=c(AST_Conditional,ah,{condition:T,consequent:ah.alternative,alternative:ah.consequent})}var X=ah.condition;var ac=ah.consequent;var V=ah.alternative;if(X instanceof AST_SymbolRef&&ac instanceof AST_SymbolRef&&X.definition()===ac.definition()){return c(AST_Binary,ah,{operator:"||",left:X,right:V})}if(ac instanceof AST_Assign&&V instanceof AST_Assign&&ac.operator==V.operator&&ac.left.equivalent_to(V.left)&&(!ah.condition.has_side_effects(Z)||ac.operator=="="&&!ac.left.has_side_effects(Z))){return c(AST_Assign,ah,{operator:ac.operator,left:ac.left,right:c(AST_Conditional,ah,{condition:ah.condition,consequent:ac.right,alternative:V.right})})}var ai;if(ac instanceof AST_Call&&V.TYPE===ac.TYPE&&ac.args.length>0&&ac.args.length==V.args.length&&ac.expression.equivalent_to(V.expression)&&!ah.condition.has_side_effects(Z)&&!ac.expression.has_side_effects(Z)&&typeof(ai=aa())=="number"){var W=ac.clone();W.args[ai]=c(AST_Conditional,ah,{condition:ah.condition,consequent:ac.args[ai],alternative:V.args[ai]});return W}if(ac instanceof AST_Conditional&&ac.alternative.equivalent_to(V)){return c(AST_Conditional,ah,{condition:c(AST_Binary,ah,{left:ah.condition,operator:"&&",right:ac.condition}),consequent:ac.consequent,alternative:V})}if(ac.equivalent_to(V)){return I(ah,[ah.condition,ac]).optimize(Z)}if((ac instanceof AST_Sequence||V instanceof AST_Sequence)&&ac.tail_node().equivalent_to(V.tail_node())){return I(ah,[c(AST_Conditional,ah,{condition:ah.condition,consequent:U(ac),alternative:U(V)}),ac.tail_node()]).optimize(Z)}if(ac instanceof AST_Binary&&ac.operator=="||"&&ac.right.equivalent_to(V)){return c(AST_Binary,ah,{operator:"||",left:c(AST_Binary,ah,{operator:"&&",left:ah.condition,right:ac.left}),right:V}).optimize(Z)}var ad=Z.option("booleans")&&Z.in_boolean_context();if(Y(ah.consequent)){if(ae(ah.alternative)){return ag(ah.condition)}return c(AST_Binary,ah,{operator:"||",left:ag(ah.condition),right:ah.alternative})}if(ae(ah.consequent)){if(Y(ah.alternative)){return ag(ah.condition.negate(Z))}return c(AST_Binary,ah,{operator:"&&",left:ag(ah.condition.negate(Z)),right:ah.alternative})}if(Y(ah.alternative)){return c(AST_Binary,ah,{operator:"||",left:ag(ah.condition.negate(Z)),right:ah.consequent})}if(ae(ah.alternative)){return c(AST_Binary,ah,{operator:"&&",left:ag(ah.condition),right:ah.consequent})}return ah;function ag(aj){if(aj.is_boolean()){return aj}return c(AST_UnaryPrefix,aj,{operator:"!",expression:aj.negate(Z)})}function Y(aj){return aj instanceof AST_True||ad&&aj instanceof AST_Constant&&aj.getValue()||(aj instanceof AST_UnaryPrefix&&aj.operator=="!"&&aj.expression instanceof AST_Constant&&!aj.expression.getValue())}function ae(aj){return aj instanceof AST_False||ad&&aj instanceof AST_Constant&&!aj.getValue()||(aj instanceof AST_UnaryPrefix&&aj.operator=="!"&&aj.expression instanceof AST_Constant&&aj.expression.getValue())}function aa(){var al=ac.args;var ak=V.args;for(var an=0,aj=al.length;an<aj;an++){if(!al[an].equivalent_to(ak[an])){for(var am=an+1;am<aj;am++){if(!al[am].equivalent_to(ak[am])){return}}return an}}}function U(aj){if(!(aj instanceof AST_Sequence)){return c(AST_Number,aj,{value:0})}return I(aj,aj.expressions.slice(0,-1))}});O(AST_Boolean,function(T,V){if(!V.option("booleans")){return T}if(V.in_boolean_context()){return c(AST_Number,T,{value:+T.value})}var U=V.parent();if(U instanceof AST_Binary&&(U.operator=="=="||U.operator=="!=")){V.warn("Non-strict equality against boolean: {operator} {value} [{file}:{line},{col}]",{operator:U.operator,value:T.value,file:U.start.file,line:U.start.line,col:U.start.col});return c(AST_Number,T,{value:+T.value})}return c(AST_UnaryPrefix,T,{operator:"!",expression:c(AST_Number,T,{value:1-T.value})})});O(AST_Sub,function(ae,ac){var U=ae.expression;var V=ae.property;if(ac.option("properties")){var aj=V.evaluate(ac);if(aj!==V){if(typeof aj=="string"){if(aj=="undefined"){aj=undefined}else{var ag=parseFloat(aj);if(ag.toString()==aj){aj=ag}}}V=ae.property=a(V,w(aj,V).transform(ac));var X=""+aj;if(is_identifier_string(X)&&X.length<=V.print_to_string().length+1){return c(AST_Dot,ae,{expression:U,property:X}).optimize(ac)}}}if(e(ae,ac.parent())){return ae}if(aj!==V){var Z=ae.flatten_object(X,ac);if(Z){U=ae.expression=Z.expression;V=ae.property=Z.property}}if(ac.option("properties")&&ac.option("side_effects")&&V instanceof AST_Number&&U instanceof AST_Array){var Y=V.getValue();var ad=U.elements;if(Y in ad){var ak=true;var T=[];for(var ah=ad.length;--ah>Y;){var ag=ad[ah].drop_side_effect_free(ac);if(ag){T.unshift(ag);if(ak&&ag.has_side_effects(ac)){ak=false}}}var af=ad[Y];af=af instanceof AST_Hole?c(AST_Undefined,af):af;if(!ak){T.unshift(af)}while(--ah>=0){var ag=ad[ah].drop_side_effect_free(ac);if(ag){T.unshift(ag)}else{Y--}}if(ak){T.push(af);return I(ae,T).optimize(ac)}else{return c(AST_Sub,ae,{expression:c(AST_Array,U,{elements:T}),property:c(AST_Number,V,{value:Y})})}}}var aa;if(ac.option("arguments")&&U instanceof AST_SymbolRef&&U.name=="arguments"&&U.definition().orig.length==1&&(aa=U.scope) instanceof AST_Lambda&&V instanceof AST_Number){var Y=V.getValue();var W=aa.argnames[Y];if(!W&&!ac.option("keep_fargs")){while(Y>=aa.argnames.length){W=c(AST_SymbolFunarg,aa,{name:aa.make_var_name("argument_"+aa.argnames.length),scope:aa});aa.argnames.push(W);aa.enclosed.push(aa.def_variable(W))}}if(W){var ab=c(AST_SymbolRef,ae,W);ab.reference({});return ab}}var ai=ae.evaluate(ac);if(ai!==ae){ai=w(ai,ae).optimize(ac);return l(ac,ai,ae)}return ae});AST_Scope.DEFMETHOD("contains_this",function(){var T;var U=this;U.walk(new TreeWalker(function(V){if(T){return true}if(V instanceof AST_This){return T=true}if(V!==U&&V instanceof AST_Scope){return true}}));return T});AST_PropAccess.DEFMETHOD("flatten_object",function(U,Z){if(!Z.option("properties")){return}var X=this.expression;if(X instanceof AST_Object){var V=X.properties;for(var T=V.length;--T>=0;){var Y=V[T];if(""+Y.key==U){if(!all(V,function(aa){return aa instanceof AST_ObjectKeyVal})){break}var W=Y.value;if(W instanceof AST_Function&&!(Z.parent() instanceof AST_New)&&W.contains_this()){break}return c(AST_Sub,this,{expression:c(AST_Array,X,{elements:V.map(function(aa){return aa.value})}),property:c(AST_Number,this,{value:T})})}}}});O(AST_Dot,function(T,Y){if(T.property=="arguments"||T.property=="caller"){Y.warn("Function.protoype.{prop} not supported [{file}:{line},{col}]",{prop:T.property,file:T.start.file,line:T.start.line,col:T.start.col})}var W=T.resolve_defines(Y);if(W){return W.optimize(Y)}if(e(T,Y.parent())){return T}if(Y.option("unsafe_proto")&&T.expression instanceof AST_Dot&&T.expression.property=="prototype"){var X=T.expression.expression;if(J(X)){switch(X.name){case"Array":T.expression=c(AST_Array,T.expression,{elements:[]});break;case"Function":T.expression=c(AST_Function,T.expression,{argnames:[],body:[]});break;case"Number":T.expression=c(AST_Number,T.expression,{value:0});break;case"Object":T.expression=c(AST_Object,T.expression,{properties:[]});break;case"RegExp":T.expression=c(AST_RegExp,T.expression,{value:/t/});break;case"String":T.expression=c(AST_String,T.expression,{value:""});break}}}var U=T.flatten_object(T.property,Y);if(U){return U.optimize(Y)}var V=T.evaluate(Y);if(V!==T){V=w(V,T).optimize(Y);return l(Y,V,T)}return T});O(AST_Return,function(T,U){if(T.value&&K(T.value,U)){T.value=null}return T});O(AST_VarDef,function(T,V){var U=V.option("global_defs");if(U&&HOP(U,T.name.name)){V.warn("global_defs "+T.name.name+" redefined [{file}:{line},{col}]",T.start)}return T})})();