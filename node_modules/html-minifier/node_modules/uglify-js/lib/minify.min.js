"use strict";var to_ascii=typeof atob=="undefined"?function(a){return new Buffer(a,"base64").toString()}:atob;var to_base64=typeof btoa=="undefined"?function(a){return new Buffer(a).toString("base64")}:btoa;function read_source_map(b,c){var a=/\n\/\/# sourceMappingURL=data:application\/json(;.*?)?;base64,(.*)/.exec(c);if(!a){AST_Node.warn("inline source map not found: "+b);return null}return to_ascii(a[2])}function parse_source_map(b){try{return JSON.parse(b)}catch(a){throw new Error("invalid input source map: "+b)}}function set_shorthand(b,a,c){if(a[b]){c.forEach(function(d){if(a[d]){if(typeof a[d]!="object"){a[d]={}}if(!(b in a[d])){a[d][b]=a[b]}}})}}function init_cache(a){if(!a){return}if(!("props" in a)){a.props=new Dictionary()}else{if(!(a.props instanceof Dictionary)){a.props=Dictionary.fromObject(a.props)}}}function to_json(a){return{props:a.props.toObject()}}function minify(files,options){var warn_function=AST_Node.warn_function;try{options=defaults(options,{compress:{},ie8:false,keep_fnames:false,mangle:{},nameCache:null,output:{},parse:{},rename:undefined,sourceMap:false,timings:false,toplevel:false,warnings:false,wrap:false},true);var timings=options.timings&&{start:Date.now()};if(options.rename===undefined){options.rename=options.compress&&options.mangle}set_shorthand("ie8",options,["compress","mangle","output"]);set_shorthand("keep_fnames",options,["compress","mangle"]);set_shorthand("toplevel",options,["compress","mangle"]);set_shorthand("warnings",options,["compress"]);var quoted_props;if(options.mangle){options.mangle=defaults(options.mangle,{cache:options.nameCache&&(options.nameCache.vars||{}),eval:false,ie8:false,keep_fnames:false,properties:false,reserved:[],toplevel:false},true);if(options.mangle.properties){if(typeof options.mangle.properties!="object"){options.mangle.properties={}}if(options.mangle.properties.keep_quoted){quoted_props=options.mangle.properties.reserved;if(!Array.isArray(quoted_props)){quoted_props=[]}options.mangle.properties.reserved=quoted_props}if(options.nameCache&&!("cache" in options.mangle.properties)){options.mangle.properties.cache=options.nameCache.props||{}}}init_cache(options.mangle.cache);init_cache(options.mangle.properties.cache)}if(options.sourceMap){options.sourceMap=defaults(options.sourceMap,{content:null,filename:null,includeSources:false,root:null,url:null},true)}var warnings=[];if(options.warnings&&!AST_Node.warn_function){AST_Node.warn_function=function(warning){warnings.push(warning)}}if(timings){timings.parse=Date.now()}var source_maps,toplevel;if(files instanceof AST_Toplevel){toplevel=files}else{if(typeof files=="string"){files=[files]}options.parse=options.parse||{};options.parse.toplevel=null;var source_map_content=options.sourceMap&&options.sourceMap.content;if(typeof source_map_content=="string"&&source_map_content!="inline"){source_map_content=parse_source_map(source_map_content)}source_maps=source_map_content&&Object.create(null);for(var name in files){if(HOP(files,name)){options.parse.filename=name;options.parse.toplevel=parse(files[name],options.parse);if(source_maps){if(source_map_content=="inline"){var inlined_content=read_source_map(name,files[name]);if(inlined_content){source_maps[name]=parse_source_map(inlined_content)}}else{source_maps[name]=source_map_content}}}}toplevel=options.parse.toplevel}if(quoted_props){reserve_quoted_keys(toplevel,quoted_props)}if(options.wrap){toplevel=toplevel.wrap_commonjs(options.wrap)}if(timings){timings.rename=Date.now()}if(options.rename){toplevel.figure_out_scope(options.mangle);toplevel.expand_names(options.mangle)}if(timings){timings.compress=Date.now()}if(options.compress){toplevel=new Compressor(options.compress).compress(toplevel)}if(timings){timings.scope=Date.now()}if(options.mangle){toplevel.figure_out_scope(options.mangle)}if(timings){timings.mangle=Date.now()}if(options.mangle){toplevel.compute_char_frequency(options.mangle);toplevel.mangle_names(options.mangle)}if(timings){timings.properties=Date.now()}if(options.mangle&&options.mangle.properties){toplevel=mangle_properties(toplevel,options.mangle.properties)}if(timings){timings.output=Date.now()}var result={};if(options.output.ast){result.ast=toplevel}if(!HOP(options.output,"code")||options.output.code){if(options.sourceMap){options.output.source_map=SourceMap({file:options.sourceMap.filename,orig:source_maps,root:options.sourceMap.root});if(options.sourceMap.includeSources){if(files instanceof AST_Toplevel){throw new Error("original source content unavailable")}else{for(var name in files){if(HOP(files,name)){options.output.source_map.get().setSourceContent(name,files[name])}}}}else{options.output.source_map.get()._sourcesContents=null}}delete options.output.ast;delete options.output.code;var stream=OutputStream(options.output);toplevel.print(stream);result.code=stream.get();if(options.sourceMap){result.map=options.output.source_map.toString();if(options.sourceMap.url=="inline"){result.code+="\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,"+to_base64(result.map)}else{if(options.sourceMap.url){result.code+="\n//# sourceMappingURL="+options.sourceMap.url}}}}if(options.nameCache&&options.mangle){if(options.mangle.cache){options.nameCache.vars=to_json(options.mangle.cache)}if(options.mangle.properties&&options.mangle.properties.cache){options.nameCache.props=to_json(options.mangle.properties.cache)}}if(timings){timings.end=Date.now();result.timings={parse:0.001*(timings.rename-timings.parse),rename:0.001*(timings.compress-timings.rename),compress:0.001*(timings.scope-timings.compress),scope:0.001*(timings.mangle-timings.scope),mangle:0.001*(timings.properties-timings.mangle),properties:0.001*(timings.output-timings.properties),output:0.001*(timings.end-timings.output),total:0.001*(timings.end-timings.start)}}if(warnings.length){result.warnings=warnings}return result}catch(ex){return{error:ex}}finally{AST_Node.warn_function=warn_function}};