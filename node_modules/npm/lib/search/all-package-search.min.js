var ms=require("mississippi");var allPackageMetadata=require("./all-package-metadata");var packageFilter=require("./package-filter.js");module.exports=allPackageSearch;function allPackageSearch(c){var d=(c.unicode?"ðŸ¤” ":"")+"search";var b=allPackageMetadata(c.staleness);var a=streamFilter(function(f){c.log.gauge.pulse("search");c.log.gauge.show({section:d,logline:"scanning "+f.name});var e=packageFilter(f,c.include,c.exclude,{description:c.description});return e});return ms.pipeline.obj(b,a)}function streamFilter(a){return ms.through.obj(function(d,c,b){if(a(d)){this.push(standardizePkg(d))}b()})}function standardizePkg(a){return{name:a.name,description:a.description,maintainers:(a.maintainers||[]).map(function(b){return{username:b.name,email:b.email}}),keywords:a.keywords||[],version:Object.keys(a.versions||{})[0]||[],date:(a.time&&a.time.modified&&new Date(a.time.modified))||null}};