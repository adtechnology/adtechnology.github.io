module.exports=logout;var dezalgo=require("dezalgo");var log=require("npmlog");var npm=require("./npm.js");var mapToRegistry=require("./utils/map-to-registry.js");logout.usage="npm logout [--registry=<url>] [--scope=<@scope>]";function afterLogout(c,a){var b=npm.config.get("scope");if(b){npm.config.del(b+":registry")}npm.config.clearCredentialsByURI(c);npm.config.save("user",a)}function logout(b,a){a=dezalgo(a);mapToRegistry("/",npm.config,function(e,d,c,f){if(e){return a(e)}if(c.token){log.verbose("logout","clearing session token for",f);npm.registry.logout(f,{auth:c},function(g){if(g){return a(g)}afterLogout(f,a)})}else{if(c.username||c.password){log.verbose("logout","clearing user credentials for",f);afterLogout(f,a)}else{a(new Error("Not logged in to",f+",","so can't log out."))}}})};