var npm=require("./npm.js");var output=require("./utils/output.js");module.exports=whoami;whoami.usage="npm whoami [--registry <registry>]\n(just prints username according to given registry)";function whoami(e,d,b){if(typeof b!=="function"){b=d;d=false}var c=npm.config.get("registry");if(!c){return b(new Error("no default registry set"))}var f=npm.config.getCredentialsByURI(c);if(f){if(f.username){if(!d){output(f.username)}return process.nextTick(b.bind(this,null,f.username))}else{if(f.token){return npm.registry.whoami(c,{auth:f},function(i,h){if(i){return b(i)}if(!h){var g=new Error("Your auth token is no longer valid. Please log in again.");g.code="ENEEDAUTH";return b(g)}if(!d){output(h)}b(null,h)})}}}var a=new Error("this command requires you to be logged in.");a.code="ENEEDAUTH";process.nextTick(b.bind(this,a))};