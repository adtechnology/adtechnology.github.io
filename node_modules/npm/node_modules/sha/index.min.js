"use strict";var Transform=require("stream").Transform||require("readable-stream").Transform;var crypto=require("crypto");var fs=require("graceful-fs");exports.check=check;exports.checkSync=checkSync;exports.get=get;exports.getSync=getSync;exports.stream=stream;function check(c,d,b,a){if(typeof b==="function"){a=b;b=undefined}d=d.toLowerCase().trim();get(c,b,function(f,e){if(f){if(f.message){f.message+=" while getting shasum for "+c}return a(f)}if(e===d){return a(null)}a(new Error("shasum check failed for "+c+"\nExpected: "+d+"\nActual:   "+e))})}function checkSync(c,d,a){d=d.toLowerCase().trim();var f;try{f=getSync(c,a)}catch(e){if(e.message){e.message+=" while getting shasum for "+c}throw e}if(f!==d){var b=new Error("shasum check failed for "+c+"\nExpected: "+d+"\nActual:   "+f);throw b}}function get(d,c,a){if(typeof c==="function"){a=c;c=undefined}c=c||{};var b=c.algorithm||"sha1";var f=crypto.createHash(b);var e=fs.createReadStream(d);var g=null;e.on("error",function(h){if(g){return}return a(g=h)}).on("data",function(h){if(g){return}f.update(h)}).on("end",function(){if(g){return}var h=f.digest("hex").toLowerCase().trim();a(null,h)})}function getSync(c,b){b=b||{};var a=b.algorithm||"sha1";var e=crypto.createHash(a);var d=fs.readFileSync(c);e.update(d);return e.digest("hex").toLowerCase().trim()}function stream(c,b){c=c.toLowerCase().trim();b=b||{};var a=b.algorithm||"sha1";var d=crypto.createHash(a);var e=new Transform();e._transform=function(f,g,h){d.update(f);e.push(f);h()};e._flush=function(f){var g=d.digest("hex").toLowerCase().trim();if(g===c){return f(null)}f(new Error("shasum check failed for:\n  Expected: "+c+"\n  Actual:   "+g));this.push(null)};return e};