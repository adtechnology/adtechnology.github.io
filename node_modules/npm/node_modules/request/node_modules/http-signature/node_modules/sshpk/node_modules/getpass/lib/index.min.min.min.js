module.exports={getPass:getPass};const mod_tty=require("tty");const mod_fs=require("fs");const mod_assert=require("assert-plus");var BACKSPACE=String.fromCharCode(127);var CTRLC="\u0003";var CTRLD="\u0004";function getPass(b,a){if(typeof(b)==="function"&&a===undefined){a=b;b={}}mod_assert.object(b,"options");mod_assert.func(a,"callback");mod_assert.optionalString(b.prompt,"options.prompt");if(b.prompt===undefined){b.prompt="Password"}openTTY(function(g,f,h,d,i){if(g){a(g);return}i.write(b.prompt+":");d.resume();d.setRawMode(true);d.resume();d.setEncoding("utf8");var e="";d.on("data",c);function c(n){var k=n.toString("utf8");for(var l=0;l<k.length;++l){var m=k[l];switch(m){case"\r":case"\n":case CTRLD:j();a(null,e);return;case CTRLC:j();a(new Error("Aborted"));return;case BACKSPACE:e=e.slice(0,e.length-1);break;default:e+=m;break}}}function j(){i.write("\r\n");d.setRawMode(false);d.pause();d.removeListener("data",c);if(h!==undefined&&h!==f){i.end();mod_fs.closeSync(h)}if(f!==undefined){d.end();mod_fs.closeSync(f)}}})}function openTTY(a){mod_fs.open("/dev/tty","r+",function(b,d){if((b&&(b.code==="ENOENT"||b.code==="EACCES"))||(process.version.match(/^v0[.][0-8][.]/))){a(null,undefined,undefined,process.stdin,process.stdout);return}var c=new mod_tty.ReadStream(d);mod_fs.open("/dev/tty","w+",function(e,g){var f=new mod_tty.WriteStream(g);if(e){a(e);return}a(null,d,g,c,f)})})};