module.exports=SSHBuffer;var assert=require("assert-plus");function SSHBuffer(b){assert.object(b,"options");if(b.buffer!==undefined){assert.buffer(b.buffer,"options.buffer")}this._size=b.buffer?b.buffer.length:1024;this._buffer=b.buffer||(new Buffer(this._size));this._offset=0}SSHBuffer.prototype.toBuffer=function(){return(this._buffer.slice(0,this._offset))};SSHBuffer.prototype.atEnd=function(){return(this._offset>=this._buffer.length)};SSHBuffer.prototype.remainder=function(){return(this._buffer.slice(this._offset))};SSHBuffer.prototype.skip=function(b){this._offset+=b};SSHBuffer.prototype.expand=function(){this._size*=2;var b=new Buffer(this._size);this._buffer.copy(b,0);this._buffer=b};SSHBuffer.prototype.readPart=function(){return({data:this.readBuffer()})};SSHBuffer.prototype.readBuffer=function(){var d=this._buffer.readUInt32BE(this._offset);this._offset+=4;assert.ok(this._offset+d<=this._buffer.length,"length out of bounds at +0x"+this._offset.toString(16)+" (data truncated?)");var c=this._buffer.slice(this._offset,this._offset+d);this._offset+=d;return(c)};SSHBuffer.prototype.readString=function(){return(this.readBuffer().toString())};SSHBuffer.prototype.readCString=function(){var c=this._offset;while(c<this._buffer.length&&this._buffer[c]!==0){c++}assert.ok(c<this._buffer.length,"c string does not terminate");var d=this._buffer.slice(this._offset,c).toString();this._offset=c+1;return(d)};SSHBuffer.prototype.readInt=function(){var b=this._buffer.readUInt32BE(this._offset);this._offset+=4;return(b)};SSHBuffer.prototype.readInt64=function(){assert.ok(this._offset+8<this._buffer.length,"buffer not long enough to read Int64");var b=this._buffer.slice(this._offset,this._offset+8);this._offset+=8;return(b)};SSHBuffer.prototype.readChar=function(){var b=this._buffer[this._offset++];return(b)};SSHBuffer.prototype.writeBuffer=function(b){while(this._offset+4+b.length>this._size){this.expand()}this._buffer.writeUInt32BE(b.length,this._offset);this._offset+=4;b.copy(this._buffer,this._offset);this._offset+=b.length};SSHBuffer.prototype.writeString=function(b){this.writeBuffer(new Buffer(b,"utf8"))};SSHBuffer.prototype.writeCString=function(b){while(this._offset+1+b.length>this._size){this.expand()}this._buffer.write(b,this._offset);this._offset+=b.length;this._buffer[this._offset++]=0};SSHBuffer.prototype.writeInt=function(b){while(this._offset+4>this._size){this.expand()}this._buffer.writeUInt32BE(b,this._offset);this._offset+=4};SSHBuffer.prototype.writeInt64=function(e){assert.buffer(e,"value");if(e.length>8){var d=e.slice(0,e.length-8);for(var f=0;f<d.length;++f){assert.strictEqual(d[f],0,"must fit in 64 bits of precision")}e=e.slice(e.length-8,e.length)}while(this._offset+8>this._size){this.expand()}e.copy(this._buffer,this._offset);this._offset+=8};SSHBuffer.prototype.writeChar=function(b){while(this._offset+1>this._size){this.expand()}this._buffer[this._offset++]=b};SSHBuffer.prototype.writePart=function(b){this.writeBuffer(b.data)};SSHBuffer.prototype.write=function(b){while(this._offset+b.length>this._size){this.expand()}b.copy(this._buffer,this._offset);this._offset+=b.length};