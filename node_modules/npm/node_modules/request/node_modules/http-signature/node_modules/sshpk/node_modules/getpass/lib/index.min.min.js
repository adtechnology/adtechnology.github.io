module.exports={getPass:getPass};const mod_tty=require("tty");const mod_fs=require("fs");const mod_assert=require("assert-plus");var BACKSPACE=String.fromCharCode(127);var CTRLC="\u0003";var CTRLD="\u0004";function getPass(c,d){if(typeof(c)==="function"&&d===undefined){d=c;c={}}mod_assert.object(c,"options");mod_assert.func(d,"callback");mod_assert.optionalString(c.prompt,"options.prompt");if(c.prompt===undefined){c.prompt="Password"}openTTY(function(k,a,p,b,o){if(k){d(k);return}o.write(c.prompt+":");b.resume();b.setRawMode(true);b.resume();b.setEncoding("utf8");var l="";b.on("data",m);function m(e){var h=e.toString("utf8");for(var g=0;g<h.length;++g){var f=h[g];switch(f){case"\r":case"\n":case CTRLD:n();d(null,l);return;case CTRLC:n();d(new Error("Aborted"));return;case BACKSPACE:l=l.slice(0,l.length-1);break;default:l+=f;break}}}function n(){o.write("\r\n");b.setRawMode(false);b.pause();b.removeListener("data",m);if(p!==undefined&&p!==a){o.end();mod_fs.closeSync(p)}if(a!==undefined){b.end();mod_fs.closeSync(a)}}})}function openTTY(b){mod_fs.open("/dev/tty","r+",function(a,e){if((a&&(a.code==="ENOENT"||a.code==="EACCES"))||(process.version.match(/^v0[.][0-8][.]/))){b(null,undefined,undefined,process.stdin,process.stdout);return}var f=new mod_tty.ReadStream(e);mod_fs.open("/dev/tty","w+",function(h,c){var d=new mod_tty.WriteStream(c);if(h){b(h);return}b(null,e,c,f,d)})})};