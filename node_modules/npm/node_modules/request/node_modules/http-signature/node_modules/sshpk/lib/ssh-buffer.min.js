module.exports=SSHBuffer;var assert=require("assert-plus");function SSHBuffer(a){assert.object(a,"options");if(a.buffer!==undefined){assert.buffer(a.buffer,"options.buffer")}this._size=a.buffer?a.buffer.length:1024;this._buffer=a.buffer||(new Buffer(this._size));this._offset=0}SSHBuffer.prototype.toBuffer=function(){return(this._buffer.slice(0,this._offset))};SSHBuffer.prototype.atEnd=function(){return(this._offset>=this._buffer.length)};SSHBuffer.prototype.remainder=function(){return(this._buffer.slice(this._offset))};SSHBuffer.prototype.skip=function(a){this._offset+=a};SSHBuffer.prototype.expand=function(){this._size*=2;var a=new Buffer(this._size);this._buffer.copy(a,0);this._buffer=a};SSHBuffer.prototype.readPart=function(){return({data:this.readBuffer()})};SSHBuffer.prototype.readBuffer=function(){var a=this._buffer.readUInt32BE(this._offset);this._offset+=4;assert.ok(this._offset+a<=this._buffer.length,"length out of bounds at +0x"+this._offset.toString(16)+" (data truncated?)");var b=this._buffer.slice(this._offset,this._offset+a);this._offset+=a;return(b)};SSHBuffer.prototype.readString=function(){return(this.readBuffer().toString())};SSHBuffer.prototype.readCString=function(){var b=this._offset;while(b<this._buffer.length&&this._buffer[b]!==0){b++}assert.ok(b<this._buffer.length,"c string does not terminate");var a=this._buffer.slice(this._offset,b).toString();this._offset=b+1;return(a)};SSHBuffer.prototype.readInt=function(){var a=this._buffer.readUInt32BE(this._offset);this._offset+=4;return(a)};SSHBuffer.prototype.readInt64=function(){assert.ok(this._offset+8<this._buffer.length,"buffer not long enough to read Int64");var a=this._buffer.slice(this._offset,this._offset+8);this._offset+=8;return(a)};SSHBuffer.prototype.readChar=function(){var a=this._buffer[this._offset++];return(a)};SSHBuffer.prototype.writeBuffer=function(a){while(this._offset+4+a.length>this._size){this.expand()}this._buffer.writeUInt32BE(a.length,this._offset);this._offset+=4;a.copy(this._buffer,this._offset);this._offset+=a.length};SSHBuffer.prototype.writeString=function(a){this.writeBuffer(new Buffer(a,"utf8"))};SSHBuffer.prototype.writeCString=function(a){while(this._offset+1+a.length>this._size){this.expand()}this._buffer.write(a,this._offset);this._offset+=a.length;this._buffer[this._offset++]=0};SSHBuffer.prototype.writeInt=function(a){while(this._offset+4>this._size){this.expand()}this._buffer.writeUInt32BE(a,this._offset);this._offset+=4};SSHBuffer.prototype.writeInt64=function(a){assert.buffer(a,"value");if(a.length>8){var b=a.slice(0,a.length-8);for(var c=0;c<b.length;++c){assert.strictEqual(b[c],0,"must fit in 64 bits of precision")}a=a.slice(a.length-8,a.length)}while(this._offset+8>this._size){this.expand()}a.copy(this._buffer,this._offset);this._offset+=8};SSHBuffer.prototype.writeChar=function(a){while(this._offset+1>this._size){this.expand()}this._buffer[this._offset++]=a};SSHBuffer.prototype.writePart=function(a){this.writeBuffer(a.data)};SSHBuffer.prototype.write=function(a){while(this._offset+a.length>this._size){this.expand()}a.copy(this._buffer,this._offset);this._offset+=a.length};