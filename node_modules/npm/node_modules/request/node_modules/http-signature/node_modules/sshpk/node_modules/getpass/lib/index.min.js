module.exports={getPass:getPass};const mod_tty=require("tty");const mod_fs=require("fs");const mod_assert=require("assert-plus");var BACKSPACE=String.fromCharCode(127);var CTRLC="\u0003";var CTRLD="\u0004";function getPass(b,a){if(typeof(b)==="function"&&a===undefined){a=b;b={}}mod_assert.object(b,"options");mod_assert.func(a,"callback");mod_assert.optionalString(b.prompt,"options.prompt");if(b.prompt===undefined){b.prompt="Password"}openTTY(function(h,j,c,i,d){if(h){a(h);return}d.write(b.prompt+":");i.resume();i.setRawMode(true);i.resume();i.setEncoding("utf8");var g="";i.on("data",f);function f(m){var n=m.toString("utf8");for(var k=0;k<n.length;++k){var l=n[k];switch(l){case"\r":case"\n":case CTRLD:e();a(null,g);return;case CTRLC:e();a(new Error("Aborted"));return;case BACKSPACE:g=g.slice(0,g.length-1);break;default:g+=l;break}}}function e(){d.write("\r\n");i.setRawMode(false);i.pause();i.removeListener("data",f);if(c!==undefined&&c!==j){d.end();mod_fs.closeSync(c)}if(j!==undefined){i.end();mod_fs.closeSync(j)}}})}function openTTY(a){mod_fs.open("/dev/tty","r+",function(b,d){if((b&&(b.code==="ENOENT"||b.code==="EACCES"))||(process.version.match(/^v0[.][0-8][.]/))){a(null,undefined,undefined,process.stdin,process.stdout);return}var c=new mod_tty.ReadStream(d);mod_fs.open("/dev/tty","w+",function(e,g){var f=new mod_tty.WriteStream(g);if(e){a(e);return}a(null,d,g,c,f)})})};