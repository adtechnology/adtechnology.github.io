module.exports={getPass:getPass};const mod_tty=require("tty");const mod_fs=require("fs");const mod_assert=require("assert-plus");var BACKSPACE=String.fromCharCode(127);var CTRLC="\u0003";var CTRLD="\u0004";function getPass(c,d){if(typeof(c)==="function"&&d===undefined){d=c;c={}}mod_assert.object(c,"options");mod_assert.func(d,"callback");mod_assert.optionalString(c.prompt,"options.prompt");if(c.prompt===undefined){c.prompt="Password"}openTTY(function(l,m,k,o,b){if(l){d(l);return}b.write(c.prompt+":");o.resume();o.setRawMode(true);o.resume();o.setEncoding("utf8");var n="";o.on("data",p);function p(h){var g=h.toString("utf8");for(var f=0;f<g.length;++f){var e=g[f];switch(e){case"\r":case"\n":case CTRLD:a();d(null,n);return;case CTRLC:a();d(new Error("Aborted"));return;case BACKSPACE:n=n.slice(0,n.length-1);break;default:n+=e;break}}}function a(){b.write("\r\n");o.setRawMode(false);o.pause();o.removeListener("data",p);if(k!==undefined&&k!==m){b.end();mod_fs.closeSync(k)}if(m!==undefined){o.end();mod_fs.closeSync(m)}}})}function openTTY(b){mod_fs.open("/dev/tty","r+",function(a,e){if((a&&(a.code==="ENOENT"||a.code==="EACCES"))||(process.version.match(/^v0[.][0-8][.]/))){b(null,undefined,undefined,process.stdin,process.stdout);return}var f=new mod_tty.ReadStream(e);mod_fs.open("/dev/tty","w+",function(h,c){var d=new mod_tty.WriteStream(c);if(h){b(h);return}b(null,e,c,f,d)})})};