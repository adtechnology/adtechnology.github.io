var mod_assert=require("assert");var mod_util=require("util");exports.sprintf=jsSprintf;exports.printf=jsPrintf;exports.fprintf=jsFprintf;function jsSprintf(c){var l=["([^%]*)","%","(['\\-+ #0]*?)","([1-9]\\d*)?","(\\.([1-9]\\d*))?","[lhjztL]*?","([diouxXfFeEgGaAcCsSp%jr])"].join("");var o=new RegExp(l);var k=Array.prototype.slice.call(arguments,1);var d,a,i,g;var f,e,b,n,h;var j="";var m=1;mod_assert.equal("string",typeof(c));while((h=o.exec(c))!==null){j+=h[1];c=c.substring(h[0].length);d=h[2]||"";a=h[3]||0;i=h[4]||"";g=h[6];f=false;b=false;e=" ";if(g=="%"){j+="%";continue}if(k.length===0){throw (new Error("too few args to sprintf"))}n=k.shift();m++;if(d.match(/[\' #]/)){throw (new Error("unsupported flags: "+d))}if(i.length>0){throw (new Error("non-zero precision not supported"))}if(d.match(/-/)){f=true}if(d.match(/0/)){e="0"}if(d.match(/\+/)){b=true}switch(g){case"s":if(n===undefined||n===null){throw (new Error("argument "+m+": attempted to print undefined or null as a string"))}j+=doPad(e,a,f,n.toString());break;case"d":n=Math.floor(n);case"f":b=b&&n>0?"+":"";j+=b+doPad(e,a,f,n.toString());break;case"x":j+=doPad(e,a,f,n.toString(16));break;case"j":if(a===0){a=10}j+=mod_util.inspect(n,false,a);break;case"r":j+=dumpException(n);break;default:throw (new Error("unsupported conversion: "+g))}}j+=c;return(j)}function jsPrintf(){var a=Array.prototype.slice.call(arguments);a.unshift(process.stdout);jsFprintf.apply(null,a)}function jsFprintf(b){var a=Array.prototype.slice.call(arguments,1);return(b.write(jsSprintf.apply(this,a)))}function doPad(c,b,d,e){var a=e;while(a.length<b){if(d){a+=c}else{a=c+a}}return(a)}function dumpException(c){var a;if(!(c instanceof Error)){throw (new Error(jsSprintf("invalid type for %%r: %j",c)))}a="EXCEPTION: "+c.constructor.name+": "+c.stack;if(c.cause&&typeof(c.cause)==="function"){var b=c.cause();if(b){a+="\nCaused by: "+dumpException(b)}}return(a)};