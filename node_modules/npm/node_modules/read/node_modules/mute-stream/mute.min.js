var Stream=require("stream");module.exports=MuteStream;function MuteStream(a){Stream.apply(this);a=a||{};this.writable=this.readable=true;this.muted=false;this.on("pipe",this._onpipe);this.replace=a.replace;this._prompt=a.prompt||null;this._hadControl=false}MuteStream.prototype=Object.create(Stream.prototype);Object.defineProperty(MuteStream.prototype,"constructor",{value:MuteStream,enumerable:false});MuteStream.prototype.mute=function(){this.muted=true};MuteStream.prototype.unmute=function(){this.muted=false};Object.defineProperty(MuteStream.prototype,"_onpipe",{value:onPipe,enumerable:false,writable:true,configurable:true});function onPipe(a){this._src=a}Object.defineProperty(MuteStream.prototype,"isTTY",{get:getIsTTY,set:setIsTTY,enumerable:true,configurable:true});function getIsTTY(){return((this._dest)?this._dest.isTTY:(this._src)?this._src.isTTY:false)}function setIsTTY(a){Object.defineProperty(this,"isTTY",{value:a,enumerable:true,writable:true,configurable:true})}Object.defineProperty(MuteStream.prototype,"rows",{get:function(){return(this._dest?this._dest.rows:this._src?this._src.rows:undefined)},enumerable:true,configurable:true});Object.defineProperty(MuteStream.prototype,"columns",{get:function(){return(this._dest?this._dest.columns:this._src?this._src.columns:undefined)},enumerable:true,configurable:true});MuteStream.prototype.pipe=function(b,a){this._dest=b;return Stream.prototype.pipe.call(this,b,a)};MuteStream.prototype.pause=function(){if(this._src){return this._src.pause()}};MuteStream.prototype.resume=function(){if(this._src){return this._src.resume()}};MuteStream.prototype.write=function(a){if(this.muted){if(!this.replace){return true}if(a.match(/^\u001b/)){if(a.indexOf(this._prompt)===0){a=a.substr(this._prompt.length);a=a.replace(/./g,this.replace);a=this._prompt+a}this._hadControl=true;return this.emit("data",a)}else{if(this._prompt&&this._hadControl&&a.indexOf(this._prompt)===0){this._hadControl=false;this.emit("data",this._prompt);a=a.substr(this._prompt.length)}a=a.toString().replace(/./g,this.replace)}}this.emit("data",a)};MuteStream.prototype.end=function(a){if(this.muted){if(a&&this.replace){a=a.toString().replace(/./g,this.replace)}else{a=null}}if(a){this.emit("data",a)}this.emit("end")};function proxy(a){return function(){var c=this._dest;var b=this._src;if(c&&c[a]){c[a].apply(c,arguments)}if(b&&b[a]){b[a].apply(b,arguments)}}}MuteStream.prototype.destroy=proxy("destroy");MuteStream.prototype.destroySoon=proxy("destroySoon");MuteStream.prototype.close=proxy("close");