var http=require("http");var https=require("https");var url=require("url");var isHttpResource=require("../utils/is-http-resource");var isHttpsResource=require("../utils/is-https-resource");var override=require("../utils/override");var HTTP_PROTOCOL="http:";function loadRemoteResource(e,f,h,g){var b=f.protocol||f.hostname;var d=false;var a;var c;a=override(url.parse(e),f||{});if(f.hostname!==undefined){a.protocol=f.protocol||HTTP_PROTOCOL;a.path=a.href}c=(b&&!isHttpsResource(b))||isHttpResource(e)?http.get:https.get;c(a,function(j){var k=[];var i;if(d){return}if(j.statusCode<200||j.statusCode>399){return g(j.statusCode,null)}else{if(j.statusCode>299){i=url.resolve(e,j.headers.location);return loadRemoteResource(i,f,h,g)}}j.on("data",function(l){k.push(l.toString())});j.on("end",function(){var l=k.join("");g(null,l)})}).on("error",function(i){if(d){return}d=true;g(i.message,null)}).on("timeout",function(){if(d){return}d=true;g("timeout",null)}).setTimeout(h)}module.exports=loadRemoteResource;