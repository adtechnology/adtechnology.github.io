var path=require("path");var url=require("url");var isRemoteResource=require("../utils/is-remote-resource");var hasProtocol=require("../utils/has-protocol");var HTTP_PROTOCOL="http:";function isAllowedResource(c,h,k){var e;var b;var j=h?false:true;var g;var f;var a;var d;if(k.length===0){return false}if(h&&!hasProtocol(c)){c=HTTP_PROTOCOL+c}e=h?url.parse(c).host:c;b=h?c:path.resolve(c);for(d=0;d<k.length;d++){g=k[d];f=g[0]=="!";a=g.substring(1);if(f&&h&&isRemoteRule(a)){j=j&&!isAllowedResource(c,true,[a])}else{if(f&&!h&&!isRemoteRule(a)){j=j&&!isAllowedResource(c,false,[a])}else{if(f){j=j&&true}else{if(g=="all"){j=true}else{if(h&&g=="local"){j=j||false}else{if(h&&g=="remote"){j=true}else{if(!h&&g=="remote"){j=false}else{if(!h&&g=="local"){j=true}else{if(g===e){j=true}else{if(g===c){j=true}else{if(h&&b.indexOf(g)===0){j=true}else{if(!h&&b.indexOf(path.resolve(g))===0){j=true}else{if(h!=isRemoteRule(a)){j=j&&true}else{j=false}}}}}}}}}}}}}}return j}function isRemoteRule(a){return isRemoteResource(a)||url.parse(HTTP_PROTOCOL+"//"+a).host==a}module.exports=isAllowedResource;