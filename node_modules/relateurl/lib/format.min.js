"use strict";var constants=require("./constants");function formatAuth(b,a){if(b.auth&&!a.removeAuth&&(b.extra.relation.maximumHost||a.output===constants.ABSOLUTE)){return b.auth+"@"}return""}function formatHash(b,a){return b.hash?b.hash:""}function formatHost(b,a){if(b.host.full&&(b.extra.relation.maximumAuth||a.output===constants.ABSOLUTE)){return b.host.full}return""}function formatPath(f,c){var g="";var b=f.path.absolute.string;var a=f.path.relative.string;var e=showResource(f,c);if(f.extra.relation.maximumHost||c.output===constants.ABSOLUTE||c.output===constants.ROOT_RELATIVE){g=b}else{if(a.length<=b.length&&c.output===constants.SHORTEST||c.output===constants.PATH_RELATIVE){g=a;if(g===""){var d=showQuery(f,c)&&!!getQuery(f,c);if(f.extra.relation.maximumPath&&!e){g="./"}else{if(f.extra.relation.overridesQuery&&!e&&!d){g="./"}}}}else{g=b}}if(g==="/"&&!e&&c.removeRootTrailingSlash&&(!f.extra.relation.minimumPort||c.output===constants.ABSOLUTE)){g=""}return g}function formatPort(b,a){if(b.port&&!b.extra.portIsDefault&&b.extra.relation.maximumHost){return":"+b.port}return""}function formatQuery(b,a){return showQuery(b,a)?getQuery(b,a):""}function formatResource(b,a){return showResource(b,a)?b.resource:""}function formatScheme(b,a){var c="";if(b.extra.relation.maximumHost||a.output===constants.ABSOLUTE){if(!b.extra.relation.minimumScheme||!a.schemeRelative||a.output===constants.ABSOLUTE){c+=b.scheme+"://"}else{c+="//"}}return c}function formatUrl(c,b){var a="";a+=formatScheme(c,b);a+=formatAuth(c,b);a+=formatHost(c,b);a+=formatPort(c,b);a+=formatPath(c,b);a+=formatResource(c,b);a+=formatQuery(c,b);a+=formatHash(c,b);return a}function getQuery(c,a){var b=a.removeEmptyQueries&&c.extra.relation.minimumPort;return c.query.string[b?"stripped":"full"]}function showQuery(b,a){return !b.extra.relation.minimumQuery||a.output===constants.ABSOLUTE||a.output===constants.ROOT_RELATIVE}function showResource(d,b){var c=b.removeDirectoryIndexes&&d.extra.resourceIsIndex;var a=d.extra.relation.minimumResource&&b.output!==constants.ABSOLUTE&&b.output!==constants.ROOT_RELATIVE;return !!d.resource&&!a&&!c}module.exports=formatUrl;